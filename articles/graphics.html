<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HTLTC-R: Graphics • htltcR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="HTLTC-R: Graphics">
<meta property="og:description" content="htltcR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">htltcR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/control.html">HTLTC-R: Control statements</a>
    </li>
    <li>
      <a href="../articles/functions.html">HTLTC-R: Functions</a>
    </li>
    <li>
      <a href="../articles/graphics.html">HTLTC-R: Graphics</a>
    </li>
    <li>
      <a href="../articles/io.html">HTLTC-R: Reading, writing, and regular expressions</a>
    </li>
    <li>
      <a href="../articles/operators.html">HTLTC-R: Operators</a>
    </li>
    <li>
      <a href="../articles/package.html">HTLTC-R: Reproducible research &amp; packages</a>
    </li>
    <li>
      <a href="../articles/palettes.html">HTLTC-R: Color packages</a>
    </li>
    <li>
      <a href="../articles/plotting-ggplot.html">HTLTC-R: Plotting with ggplot2</a>
    </li>
    <li>
      <a href="../articles/plotting.html">HTLTC-R: Plotting</a>
    </li>
    <li>
      <a href="../articles/structures.html">HTLTC-R: Data structures &amp; subsetting</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>HTLTC-R: Graphics</h1>
            
      
      
      <div class="hidden name"><code>graphics.Rmd</code></div>

    </div>

    
    
<div id="using-this-document" class="section level3">
<h3 class="hasAnchor">
<a href="#using-this-document" class="anchor"></a>Using this document</h3>
<ul>
<li>Code blocks and R code have a grey background (note, code nested in the text is not highlighted in the pdf version of this document but is a different font).</li>
<li># indicates a comment, and anything after a comment will not be evaluated in R</li>
<li>The comments beginning with ## under the code in the grey code boxes are the output from the code directly above; any comments added by us will start with a single #</li>
<li>While you can copy and paste code into R, you will learn faster if you type out the commands yourself.</li>
<li>Read through the document after class. This is meant to be a reference, and ideally, you should be able to understand every line of code. If there is something you do not understand please email us with questions or ask in the following class (you’re probably not the only one with the same question!).</li>
</ul>
</div>
<div id="goals" class="section level3">
<h3 class="hasAnchor">
<a href="#goals" class="anchor"></a>Goals</h3>
<ol style="list-style-type: decimal">
<li>Understand the basics of the graphics system</li>
<li>Know the different plotting regions</li>
<li>Know the different coordinate systems</li>
<li>Learn the basic graphics tools to draw &amp; annotate custom plots</li>
</ol>
</div>
<div id="the-r-graphics-system" class="section level3">
<h3 class="hasAnchor">
<a href="#the-r-graphics-system" class="anchor"></a>The R graphics system</h3>
<p>R has two engines for graphing: the <em>graphics</em> engine and the <em>grid</em> engine. The grid engine is arguably more flexible, but also more complicated. In this class we will only discuss the graphics engine. Before we start discussing the details of the engine, we will illustrate some of the basic plotting functionality. The most common starting for a plot is calling the <code>plot</code> function. This function is essentially a wrapper for MANY functions that give you an easy way to make a very basic plot.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="fl">0</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-1-1.png" width="384" style="display: block; margin: auto;"></p>
<p>The <code>plot</code> function will take many data types and structures, and will produce different plots based on the input.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">1</span>:<span class="fl">10</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>)) <span class="co"># scatterplot</span>
<span class="co"># boxplot</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">letters</span>[<span class="fl">1</span>:<span class="fl">5</span>], <span class="kw">each</span> <span class="kw">=</span> <span class="fl">2</span>), <span class="fl">1</span>:<span class="fl">10</span>, <span class="kw">stringsAsFactors</span> <span class="kw">=</span> <span class="fl">TRUE</span>))</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-2-1.png" width="326.4"><img src="graphics_files/figure-html/unnamed-chunk-2-2.png" width="326.4"></p>
<p>There are many guides on how to change the parameters of <code>plot</code>, as well as other high-level functions like <code>barplot</code>, <code>boxplot</code>, <code>hist</code>, etc. A good first step is to read through <code><a href="https://rdrr.io/r/base/plot.html">?plot</a></code>. Rather than belabor lists of arguments, we will discuss the fundamentals of the grahics system.</p>
</div>
<div id="plotting-devices" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting-devices" class="anchor"></a>Plotting devices</h3>
<p>Both the graphics and the grid system start with the generation of a plotting device. The creation and management of devices are controlled by the <code>dev.*</code> functions. In addition to the <code>dev.*</code> functions there are many special device functions (<code>pdf</code>, <code>png</code>, etc.) that open a device and write directly to a file. Note: when using one of the special graphics drivers none of the graphics are shown until the device is closed and the generated file is opened. Using these device calls will allow generating high-quality manuscript-ready figures. At any time we can look at the open devices using <code><a href="https://rdrr.io/r/grDevices/dev.html">dev.list()</a></code> and <code><a href="https://rdrr.io/r/grDevices/dev.html">dev.cur()</a></code>.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># We start with no open devices</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.list</a></span>()
<span class="co">## NULL</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.cur</a></span>() <span class="co"># lists the active device, here null because no device open</span>
<span class="co">## null device </span>
<span class="co">##           1</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span>()) <span class="co"># open a new pdf device</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.list</a></span>() <span class="co"># 1 is not shown, but always represents the null device</span>
<span class="co">## pdf </span>
<span class="co">##   2</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.cur</a></span>()
<span class="co">## pdf </span>
<span class="co">##   2</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html">pdf</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span>())
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.list</a></span>()
<span class="co">## pdf pdf </span>
<span class="co">##   2   3</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.cur</a></span>()
<span class="co">## pdf </span>
<span class="co">##   3</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.set</a></span>(<span class="fl">2</span>)
<span class="co">## pdf </span>
<span class="co">##   2</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.cur</a></span>()
<span class="co">## pdf </span>
<span class="co">##   2</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>(<span class="fl">2</span>); <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>(<span class="fl">3</span>)
<span class="co">## pdf </span>
<span class="co">##   3</span>
<span class="co">## null device </span>
<span class="co">##           1</span></pre></body></html></div>
<p>With the exception of <code>dev.list</code>, the value returned by the <code>dev.</code> functions is the current device after the function call. We can see opening and closing devices change the current device.</p>
</div>
<div id="drawing-regions" class="section level3">
<h3 class="hasAnchor">
<a href="#drawing-regions" class="anchor"></a>Drawing regions</h3>
<p>The next step in the process is to define the drawing regions. The drawing regions are set by calling <code><a href="https://rdrr.io/r/graphics/frame.html">plot.new()</a></code>. <code><a href="https://rdrr.io/r/graphics/frame.html">plot.new()</a></code> establishes the drawing regions in the device based on the current settings of <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code>. The <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> function stores the current plotting parameters. Reading <code><a href="https://rdrr.io/r/graphics/par.html">?par</a></code> is incredibly valuable. Here, we will only go over a select number of the plotting parameters. Running <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> returns a named list with one element per parameter.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>()) <span class="co"># There are MANY parameters</span>
<span class="co">## [1] 72</span>
<span class="co"># Easiest to call the parameter of interest by name, here we are just</span>
<span class="co"># telling R to subset the returned list with the `$` operator.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>()$<span class="no">mar</span>
<span class="co">## [1] 5.1 4.1 4.1 2.1</span>
<span class="co"># The values for parameters can be changed by setting them within the</span>
<span class="co"># function.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>()$<span class="no">mar</span>
<span class="co">## [1] 1 1 1 1</span></pre></body></html></div>
<p><code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> controls everything from default colors and plotting symbols to the style of the default axes. <strong><em>It is important to understand that everytime a new device is created <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> is reset to the defaults.</em></strong> Here we are interested in the drawing regions and how to define them. The figure below illustrates the three regions.</p>
<p><img src="graphics_files/figure-html/unnamed-chunk-6-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The device region is simply the device we are plotting in – controlled by the size of the device. The device region is also known as the “outer” region. The figure and plotting regions are defined relative to the size of the device. The size interactive devices – like the one built into RStudio – can be changed. The size of static devices (like the device created by <code><a href="https://rdrr.io/r/grDevices/pdf.html">pdf()</a></code>) are defined when the device is created (eg. the <em><code>width</code></em> and <em><code>height</code></em> parameters in <code>pdf</code>). The figure and plotting regions are defined by the <code>oma</code> and <code>mar</code> settings in <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code>. <code>oma</code> stands for “outter margins” – meaning the number of lines of text between the figure region and the edge of the device. <code>mar</code> stands for “margins” – meaning the number of lines of text between the plotting region and the edge of the figure region. Each setting takes a numeric vector of the format <code><a href="https://rdrr.io/r/base/c.html">c(bottom, left, top, right)</a></code>. There is another drawing region not shown above called the “inner” region, which will be addressed during the discussion about organizing multiple plots in one device (below). The above figure was created by setting both <em><code>oma</code></em> and <em><code>mar</code></em> to <code><a href="https://rdrr.io/r/base/c.html">c(2, 5, 2, 2)</a></code>.</p>
<p><img src="graphics_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The above plot is key in understanding how to draw things within the graphics engine. Many of the drawing functions rely on specifying the side, line, and whether to draw in the outer margins. Notice the “0” line rests on the interior drawing region, eg. the inner line 0 rests on the plotting region and the outer line 0 rests on the figure region. Here the text is drawn such that it is justfied above the line.</p>
<p>By default, <code>par()$oma = c(0, 0, 0, 0)</code> – meaning that R does not typically include any outer margins and the figure region fills the whole device. We can think of the plotting region as the space where the data goes, and the figure margin space as where we draw the axes, axis labels, title, etc. When using the high-level plotting functions, such as <code>plot</code>, R will define the scale of the plotting region based on the supplied data. Here the scale means what values fit into the x and y axes, eg. x ranges from 0 to 100 and y ranges from 5 to 6. Only data within the scale of the plotting region will be included (unless we tell R otherwise – more on that later). The scale of the plotting region is stored by <code>usr</code>. Now we will go through the first couple steps of constructing a plot from scratch, tracking how each step effects <code>par()$usr</code>.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># usr is c(x-min, x-max, y-min, y-max)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>()$<span class="no">usr</span> <span class="co"># c(0, 1, 0, 1) by default</span>
<span class="co">## [1] 0 1 0 1</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/frame.html">plot.new</a></span>() <span class="co"># setup a new plot </span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>()$<span class="no">usr</span>
<span class="co">## [1] -0.04  1.04 -0.04  1.04</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">plot.window</a></span>(<span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">100</span>), <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>, <span class="fl">6</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>()$<span class="no">usr</span>
<span class="co">## [1]  -4.00 104.00   4.96   6.04</span>
<span class="co"># Note the default margins</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>()$<span class="no">mar</span>
<span class="co">## [1] 5.1 4.1 4.1 2.1</span>
<span class="fu"><a href="../reference/labelLines.html">labelLines</a></span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.5</span>) <span class="co"># custom function for illustration (ignore)</span></pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-8-1.png" width="576" style="display: block; margin: auto;"></p>
<p>First note you do not need to call a new device manually, <code>plot.new</code> will handle that for you. Second, note that <code>plot.window</code> behaves differently than setting <em><code>usr</code></em> directly with <code>par</code>. Using <code>plot.window</code> adds 4% to the given range (the default behavior). When using <code>plot</code>, R finds the range of the given data and adds 4%. Here we can see the span of 5 and 6 is 1, so 0.04 is added and subtracted giving the final <em><code>usr</code></em> values.</p>
</div>
<div id="drawing-in-graphics" class="section level3">
<h3 class="hasAnchor">
<a href="#drawing-in-graphics" class="anchor"></a>Drawing in graphics</h3>
<p>Now that we have the ability to call a new device define the drawing regions, we will discuss how to draw the plot elements in the device. Both the graphics and grid engines use follow a paint-like system for drawing. Each addition to the device is “painted” on, meaning that the first of overlapping drawings will be covered by subsequent drawings. The following code illustrates this.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/frame.html">plot.new</a></span>()
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="fl">4</span>), <span class="kw">usr</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">2</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.9</span>, <span class="fl">0.9</span>,  <span class="fl">1.1</span>, <span class="fl">1.1</span>),
        <span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.9</span>, <span class="fl">1.1</span>,  <span class="fl">1.1</span>, <span class="fl">0.9</span>),
        <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="../reference/col2alpha.html">col2alpha</a></span>(<span class="st">"darkblue"</span>, <span class="fl">0.5</span>),
        <span class="kw">border</span> <span class="kw">=</span> <span class="fl">NA</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.6</span>, <span class="fl">0.6</span>,  <span class="fl">1.4</span>, <span class="fl">1.4</span>),
        <span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.6</span>, <span class="fl">1.4</span>,  <span class="fl">1.4</span>, <span class="fl">0.6</span>),
        <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="../reference/col2alpha.html">col2alpha</a></span>(<span class="st">"darkred"</span>, <span class="fl">0.5</span>),
        <span class="kw">border</span> <span class="kw">=</span> <span class="fl">NA</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.9</span>, <span class="fl">0.9</span>,  <span class="fl">1.1</span>, <span class="fl">1.1</span>) + <span class="fl">1</span>,
        <span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.9</span>, <span class="fl">1.1</span>,  <span class="fl">1.1</span>, <span class="fl">0.9</span>),
        <span class="kw">col</span> <span class="kw">=</span> <span class="st">"darkblue"</span>,
        <span class="kw">border</span> <span class="kw">=</span> <span class="fl">NA</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html">polygon</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.6</span>, <span class="fl">0.6</span>,  <span class="fl">1.4</span>, <span class="fl">1.4</span>) + <span class="fl">1</span>,
        <span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.6</span>, <span class="fl">1.4</span>,  <span class="fl">1.4</span>, <span class="fl">0.6</span>),
        <span class="kw">col</span> <span class="kw">=</span> <span class="st">"darkred"</span>,
        <span class="kw">border</span> <span class="kw">=</span> <span class="fl">NA</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Here we use a custom function to make the colors transparent for the left squares, drawn by the function <code>polygon</code>. You can see R draws the blue square first, then the red square over the blue square. <code>polygon</code> works by drawing a polygon with vertices at the given x and y cooridnates. Note that <code>polygon</code> will complete the path to the starting point, ie. we did not need to add the starting point at the end of each vector. (We chose to use <code>par</code> to set the scale of the plotting region without margins, so that we could specify the device size – 6"x4" – such that the drawings were exactly square.)</p>
<p>We will now go through the functions needed to add the common plot elements, discussing how to customize each element. Consider the following plot:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">100</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">10</span>)
<span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">5</span>, <span class="fl">6</span>,   <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">10</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/frame.html">plot.new</a></span>()
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">plot.window</a></span>(<span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">100</span>), <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>, <span class="fl">6</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>() <span class="co"># Draws the outer frame</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="kw">side</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="co"># Draws the x-axis (recall the side definitions!)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="kw">side</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="kw">side</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="st">"x-axis"</span>, <span class="kw">line</span> <span class="kw">=</span> <span class="fl">3</span>) <span class="co"># Draws text in the margin </span>
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="kw">side</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="st">"y-axis"</span>, <span class="kw">line</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span>(<span class="kw">main</span> <span class="kw">=</span> <span class="st">"A plot to learn from"</span>) <span class="co"># Draws the title</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>) <span class="co"># Draw points on the plot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"topleft"</span>, <span class="kw">legend</span> <span class="kw">=</span> <span class="st">"Some data"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="co"># Finally, draw a legend</span></pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto;"></p>
<p>First note, the above plot (excluding the legend) can be created using the <code>plot</code> command:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>,
     <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"x-axis"</span>,
     <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"y-axis"</span>,
     <span class="kw">main</span> <span class="kw">=</span> <span class="st">"A plot to learn from"</span>)</pre></body></html></div>
<p>However, we want to understand the individual components so that we can easily customize the plot to prepare manuscript-ready figures without any manual manipulation.</p>
<p>Keep in mind there are many ways to skin a cat! We will use <code>x</code> and <code>y</code> as defined above and initiate each plot with <code><a href="https://rdrr.io/r/base/plot.html">plot(x = x, y = y, ann = FALSE, axes = FALSE, type = "n")</a></code>. This is a shortcut to calling <code>plot.new</code> and then <code>plot.window</code>. The call to <code>plot</code> says plot this data with no annotations (axis labels or title), no axes, and with type “n” (meaning don’t draw the points, either). Note, the <em><code>axes = FALSE</code></em> also suppresses the plot frame. It saves a couple lines of code and does the dirty work of defining the scale of the plotting region for us. Best of all, it demonstrates another way to accomplish the same task. For each of the following sections we will discuss one aspect of the plot. For each function we encourage reading the help page.</p>
</div>
<div id="plot-frame" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-frame" class="anchor"></a>Plot frame</h3>
<p>To frame or not to frame? As mentioned above, setting <em><code>axes = FALSE</code></em> when calling <code>plot</code> suppresses the plotting frame. Some people like include a frame around the plot, others do not. When starting with a blank canvas the <code>box</code> function draws a frame around the plotting region.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">oma</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>, <span class="fl">4</span>))
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"n"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>() <span class="co"># default, which = "plot"</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">which</span> <span class="kw">=</span> <span class="st">"figure"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">which</span> <span class="kw">=</span> <span class="st">"outer"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"blue"</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-12-1.png" width="576" style="display: block; margin: auto;"></p>
<p>By default, <code>box</code> draws a frame around the figure region. Here we see it can also draw frames around the figure and device regions. Notice the blue line (device region) is half as thick as the others – this occurs because the line is drawn on the border, so half of the line is off the device. One way to remedy this is by changing the line thickness, controlled by the parameter <em><code>lwd</code></em>, eg. <code><a href="https://rdrr.io/r/graphics/box.html">box(which = "outer", col = "blue", lwd = 2)</a></code>.</p>
</div>
<div id="axes" class="section level3">
<h3 class="hasAnchor">
<a href="#axes" class="anchor"></a>Axes</h3>
<p>The default position of the axes is controlled by the <em><code>mgp</code></em> setting, which specifies the margin line location for the axis title, tick labels, and axis line, respectively. By default <em><code>mgp</code></em> is <code><a href="https://rdrr.io/r/base/c.html">c(3, 1, 0)</a></code>. This gives some insight as to why the default margin sizes are <code>c(5, 4, 4, 2) + 0.1</code>. R leaves room for axes on the bottom and left sides (sides 1 and 2, respectively). There is additional room left on the bottom for a subtitle, and room left on the top for the title. We draw axes with the <code>axis</code> function, which allows you to override any of the defaults. Consider the following:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"n"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>()
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="kw">side</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">line</span> <span class="kw">=</span> <span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="kw">side</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">line</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-13-1.png" width="576" style="display: block; margin: auto;"></p>
<p>We used the <em><code>line</code></em> parameter to override the default axis location, drawing the axis at margin line 1 rather than 0. Suppose we want a plot where the x and y axes lay on the 0 lines rather than the edge of the plot. Here we need to use the <em><code>pos</code></em> parameter. We do not know which <em><code>line</code></em> represents the center of the plot, but <em><code>pos</code></em> takes values in the plotting region. Note, specifying <em><code>pos</code></em> overrides any specification of <em><code>line</code></em>.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw">x</span> <span class="kw">=</span> -<span class="fl">5</span>:<span class="fl">5</span>, <span class="kw">y</span> <span class="kw">=</span> -<span class="fl">5</span>:<span class="fl">5</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"n"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="kw">side</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">pos</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">line</span> <span class="kw">=</span> <span class="fl">0</span>) <span class="co"># this shows how pos overrides line</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="kw">side</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">pos</span> <span class="kw">=</span> <span class="fl">0</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-14-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Now the axes are where we want, but the ticks and labels still need work.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="fl">4</span>))
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw">x</span> <span class="kw">=</span> -<span class="fl">5</span>:<span class="fl">5</span>, <span class="kw">y</span> <span class="kw">=</span> -<span class="fl">5</span>:<span class="fl">5</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"n"</span>)
<span class="no">loc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">5</span>:-<span class="fl">1</span>, <span class="fl">1</span>:<span class="fl">5</span>)
<span class="no">lbl</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">""</span>, <span class="fl">8</span>), <span class="fl">5</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="kw">side</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">pos</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">at</span> <span class="kw">=</span> <span class="no">loc</span>, <span class="kw">labels</span> <span class="kw">=</span> <span class="fl">NA</span>, <span class="kw">tcl</span> <span class="kw">=</span> <span class="fl">0.5</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="kw">side</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">pos</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">at</span> <span class="kw">=</span> <span class="no">loc</span>, <span class="kw">labels</span> <span class="kw">=</span> <span class="fl">NA</span>, <span class="kw">tcl</span> <span class="kw">=</span> <span class="fl">0.5</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="kw">side</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">pos</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">at</span> <span class="kw">=</span> <span class="no">loc</span>, <span class="kw">cex.axis</span> <span class="kw">=</span> <span class="fl">0.75</span>, <span class="kw">labels</span> <span class="kw">=</span> <span class="no">lbl</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span>(<span class="kw">side</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">pos</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">at</span> <span class="kw">=</span> <span class="no">loc</span>, <span class="kw">cex.axis</span> <span class="kw">=</span> <span class="fl">0.75</span>, <span class="kw">labels</span> <span class="kw">=</span> <span class="no">lbl</span>, <span class="kw">las</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-15-1.png" width="432" style="display: block; margin: auto;"></p>
<p>The <code>axis</code> function only draws tick marks on one side of the axis. The length of the tick marks is controlled by <em><code>tcl</code></em>, which specifies the length as a fraction of the height of a line of text. The default is -0.5, meaning draw a half-character height tick mark away from the plotting region. Here we used two calls to <code>axis</code> for each axis to create ticks that point in both directions. We also specified the tick locations with <em><code>at</code></em> and the tick labels with <em><code>labels</code></em>. The label sizes are controlled by <em><code>cex.axis</code></em> and the y-axis labels were rotated with <em><code>las</code></em>. Again, it is really helpful to read <code><a href="https://rdrr.io/r/graphics/par.html">?par</a></code> to better understand each of these settings. <em><code>cex</code></em> controls text size, specifying how much the “plotting text and symbols should be magnified relative to the default”. Here, <em><code>cex.axis</code></em> is a special setting which only affects the axis label text.</p>
</div>
<div id="titles" class="section level3">
<h3 class="hasAnchor">
<a href="#titles" class="anchor"></a>Titles</h3>
<p>Titles are most simply drawn with the <code>title</code> function.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">2</span>) + <span class="fl">0.1</span>)
<span class="co"># bty = "n" suppresses the frame; read ?par for more info!</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"n"</span>)
<span class="fu"><a href="../reference/labelLines.html">labelLines</a></span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span>(<span class="kw">main</span> <span class="kw">=</span> <span class="st">"Title w/\n2 lines"</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"x"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"y"</span>, <span class="kw">sub</span> <span class="kw">=</span> <span class="st">"Sub title"</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-16-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Notice in “A plot to learn from” we used <code>mtext</code> in place of <code>title</code> to draw the axis titles. We can think of <code>title</code> as making calls to <code>mtext</code> to specify the axis titles and the subtitle (although not technically true). Again, the location of the axis titles is controlled by <em><code>mgp[1]</code></em>, and the location of the subtitle defaults to <em><code>mgp[1] + 1</code></em> (which is why the default bottom margin has 1 more line than the default left margin!). We see the the position of the main title is centered in the top margin space. The main title can be moved to the outer margins by setting <em><code>outer = TRUE</code></em>.</p>
</div>
<div id="adding-data" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-data" class="anchor"></a>Adding data</h3>
<p>As with <code>title</code> and <code>mtext</code>, we can think of <code>plot</code> calling another function – <code>points</code> – to draw the data (again, technically not true, but useful to conceptualize the plotting).</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"n"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-17-1.png" width="576" style="display: block; margin: auto;"></p>
<p><code>points</code> adds plot symbols at the given coordinates. First, we will discuss the different point “types” specified by the <em><code>type</code></em> parameter. From the documentation, <em><code>type</code></em> is a:</p>
<blockquote>
<p>1-character string giving the type of plot desired. The following values are possible, for details, see plot: “p” for points, “l” for lines, “b” for both points and lines, “c” for empty points joined by lines, “o” for overplotted points and lines, “s” and “S” for stair steps and “h” for histogram-like vertical lines. Finally, “n” does not produce any points or lines.</p>
</blockquote>
<p><img src="graphics_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can also customize the plotting symbols, their color, and size.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"n"</span>)
<span class="no">sz</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">10</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"darkred"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="no">letters</span>[<span class="fl">1</span>:<span class="fl">10</span>], <span class="kw">font</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="no">sz</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"darkblue"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"c"</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-19-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The above figure highlights a lot of new parameters. <em><code>col</code></em> defines the color, <em><code>pch</code></em> defines the plotting symbol (here we used letters), <em><code>cex</code></em> (as discussed above) defines the relative size of the symbols, and <em><code>font = 2</code></em> tells the function to plot the bold version of the letters. <em><code>type = "p"</code></em> by default, so the first call to <code>points</code> just drew the red letters. The second call drew the blue lines (with double line thickness) between the symbols. Notice the parameters can take vectors, specifying different values for each point. There are many options for plotting symbols, which are summarized below<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>:</p>
<p><img src="graphics_files/figure-html/unnamed-chunk-20-1.png" width="576" style="display: block; margin: auto;"></p>
<p>It also is important to note that drawing is generally clipped to the plotting region. The clippingi is controlled by <code><a href="https://rdrr.io/r/graphics/par.html">par('xpd')</a></code>. When <code>xpd = FALSE</code> (the default) all drawing is clipped to the plotting region; when <code>xpd = TRUE</code> all drawing is clipped to the figure region; when <code>xpd = NA</code> drawing is not clipped. Consider the following:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">demoPlot</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">xpd</span>) {
  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">oma</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">2</span>, <span class="fl">4</span>), <span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">2</span>, <span class="fl">4</span>))
  <span class="fu"><a href="https://rdrr.io/r/graphics/frame.html">plot.new</a></span>()
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">plot.window</a></span>(<span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">7</span>), <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>, <span class="fl">7</span>))
  <span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"xpd ="</span>, <span class="no">xpd</span>))
  <span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">col</span> <span class="kw">=</span> <span class="st">"gray40"</span>)
  <span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">which</span> <span class="kw">=</span> <span class="st">"inner"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"darkred"</span>)
  <span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">which</span> <span class="kw">=</span> <span class="st">"outer"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"darkgreen"</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)
  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="fl">1</span>:<span class="fl">10</span>, <span class="fl">1</span>:<span class="fl">10</span>, <span class="kw">xpd</span> <span class="kw">=</span> <span class="no">xpd</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="fl">1</span>:<span class="fl">10</span>))
}
<span class="fu">demoPlot</span>(<span class="fl">FALSE</span>)
<span class="fu">demoPlot</span>(<span class="fl">TRUE</span>)
<span class="fu">demoPlot</span>(<span class="fl">NA</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-21-1.png" width="215"><img src="graphics_files/figure-html/unnamed-chunk-21-2.png" width="215"><img src="graphics_files/figure-html/unnamed-chunk-21-3.png" width="215"></p>
<p>Note, there is also the <code><a href="https://rdrr.io/r/graphics/clip.html">clip()</a></code> function for defining a custom clipping region.</p>
</div>
<div id="adding-text" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-text" class="anchor"></a>Adding text</h3>
<p>Text is drawn using the <code>text</code> function.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="fl">4</span>), <span class="kw">pty</span> <span class="kw">=</span> <span class="st">"s"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="fl">0</span>:<span class="fl">3</span>, <span class="fl">0</span>:<span class="fl">3</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="no">xpos</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>)
<span class="no">ypos</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>)
<span class="no">tstr</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"this"</span>, <span class="st">"is"</span>, <span class="st">"adding"</span>, <span class="st">"text"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="no">xpos</span>, <span class="no">ypos</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="no">xpos</span>, <span class="no">ypos</span>, <span class="no">tstr</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-22-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Notice the text is centered in for both x and y dimensions on the given point. We can change the position of the text, relative to the point, with the <em><code>adj</code></em> parameter (stored by <code>par</code>). When <code>adj = 0.5</code> (the default) it means to center in both dimensions. However, we can give separate values for the x and y dimensions (<code><a href="https://rdrr.io/r/base/c.html">c(x, y)</a></code>). Both x and y can be given values <code>[0, 1]</code> where 0 means left/bottom jusified and 1 means right/top justified. Note: <em><code>adj</code></em> when set by <code>par</code> will also control the alignment of <code>title</code> and <code>mtext</code>.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="fl">4</span>), <span class="kw">pty</span> <span class="kw">=</span> <span class="st">"s"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="fl">0</span>:<span class="fl">3</span>, <span class="fl">0</span>:<span class="fl">3</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="no">xpos</span>, <span class="no">ypos</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">xpos</span>)) {
  <span class="no">adjX</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>)[<span class="no">i</span>]
  <span class="no">adjY</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>)[<span class="no">i</span>]
  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="no">xpos</span>[<span class="no">i</span>], <span class="no">ypos</span>[<span class="no">i</span>], <span class="no">tstr</span>[<span class="no">i</span>], <span class="kw">adj</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">adjX</span>, <span class="no">adjY</span>))
}</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-23-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Text can be rotated by the <em><code>srt</code></em> parameter (also stored by <code>par</code>). <em><code>srt</code></em> accepts numeric values indicating the degrees of rotation from the anchor point for the text. When <code>adj = 0.5</code> the anchor point is the center of the text. When <code>adj = c(0, 1)</code> the top-left corner of the “box” surrounding the text is the anchor point.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="fl">4</span>), <span class="kw">pty</span> <span class="kw">=</span> <span class="st">"s"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="fl">0</span>:<span class="fl">3</span>, <span class="fl">0</span>:<span class="fl">3</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="no">xpos</span>, <span class="no">ypos</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">xpos</span>)) {
  <span class="no">adjX</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>)[<span class="no">i</span>]
  <span class="no">adjY</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>)[<span class="no">i</span>]
  <span class="no">srt</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">45</span>, <span class="fl">90</span>, <span class="fl">135</span>)[<span class="no">i</span>]
  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="no">xpos</span>[<span class="no">i</span>], <span class="no">ypos</span>[<span class="no">i</span>], <span class="no">tstr</span>[<span class="no">i</span>], <span class="kw">adj</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">adjX</span>, <span class="no">adjY</span>), <span class="kw">srt</span> <span class="kw">=</span> <span class="no">srt</span>)
}</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-24-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Finally, the <em><code>font</code></em> and <em><code>family</code></em> parameters control the type of letters (normal, bold, italic, bold &amp; italic) and the font family (“serif”, “sans”, “mono”). The default value for <em><code>family</code></em> is <code>""</code>, which indicates to use the default family for the current device.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="fl">4</span>), <span class="kw">pty</span> <span class="kw">=</span> <span class="st">"s"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/frame.html">plot.new</a></span>()
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">plot.window</a></span>(<span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">5</span>), <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">4</span>))
<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fl">3</span>) {
  <span class="no">fam</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"serif"</span>, <span class="st">"sans"</span>, <span class="st">"mono"</span>)[<span class="no">i</span>]
  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span>(<span class="fl">1</span>:<span class="fl">4</span>, <span class="no">i</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="st">"adding"</span>, <span class="no">fam</span>, <span class="no">tstr</span>), <span class="kw">family</span> <span class="kw">=</span> <span class="no">fam</span>, <span class="kw">font</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">4</span>)
}</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-25-1.png" width="700" style="display: block; margin: auto;"></p>
<p>In addition to the <code>text</code> function, we can use the <code>mtext</code> function to easily label axes. <code>mtext</code> draws text outside the margins (without specifying <em><code>xpd</code></em>) based on the given side and margin line. Using the <em><code>outer</code></em> parameter, <code>mtext</code> will also draw text in the outer margins.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>), <span class="kw">oma</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="fl">1</span>:<span class="fl">10</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"s"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">col</span> <span class="kw">=</span> <span class="st">"gray40"</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">which</span> <span class="kw">=</span> <span class="st">"figure"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"darkred"</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">which</span> <span class="kw">=</span> <span class="st">"outer"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"darkgreen"</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">4</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="kw">text</span> <span class="kw">=</span> <span class="st">"text for x axis"</span>, <span class="kw">side</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">line</span> <span class="kw">=</span> <span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="kw">text</span> <span class="kw">=</span> <span class="st">"text for y axis"</span>, <span class="kw">side</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">line</span> <span class="kw">=</span> <span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span>(<span class="kw">text</span> <span class="kw">=</span> <span class="st">"text for outer title"</span>, <span class="kw">side</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">line</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">outer</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-26-1.png" width="624" style="display: block; margin: auto;"></p>
<p>For scientific plotting, you should read <code><a href="https://rdrr.io/r/grDevices/plotmath.html">?plotmath</a></code> which describes how to add special symbols and forumulae to your plots.</p>
</div>
<div id="legends" class="section level3">
<h3 class="hasAnchor">
<a href="#legends" class="anchor"></a>Legends</h3>
<p>The <code><a href="https://rdrr.io/r/graphics/legend.html">legend()</a></code> function draws a legend or key. Let’s take a look at a simple example using the iris dataset:</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">iris</span>)
<span class="no">irisScatter</span> <span class="kw">&lt;-</span> <span class="kw">function</span>() {
  <span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">iris</span>$<span class="no">Sepal.Length</span>,
     <span class="kw">y</span> <span class="kw">=</span> <span class="no">iris</span>$<span class="no">Petal.Length</span>,
     <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span>(<span class="no">iris</span>$<span class="no">Species</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"setosa"</span>, <span class="st">"versicolor"</span>, <span class="st">"virginica"</span>)),
     <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">16</span>)
}
<span class="fu">irisScatter</span>()
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">4.5</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="fl">7</span>,
       <span class="kw">legend</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"setosa"</span>, <span class="st">"versicolor"</span>, <span class="st">"virginica"</span>),
       <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fl">3</span>),
       <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">16</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">4.5</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">7</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">3</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-27-1.png" width="624" style="display: block; margin: auto;"></p>
<p>Notice the x and y coordinates are used to position the legend in the graph. By default, the given x and y coordinates specify the top left corner of the legend. The position of the legend can also be specified using the following keywords: “bottomright”, “bottom”, “bottomleft”, “left”, “topleft”, “top”, “topright”, “right” and “center”:</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="fu">irisScatter</span>()
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"bottomright"</span>,
       <span class="kw">legend</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"setosa"</span>, <span class="st">"versicolor"</span>, <span class="st">"virginica"</span>),
       <span class="kw">fill</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fl">3</span>),
       <span class="kw">border</span> <span class="kw">=</span> <span class="st">"white"</span>,
       <span class="kw">title</span> <span class="kw">=</span> <span class="st">"Species"</span>,
       <span class="kw">bty</span> <span class="kw">=</span> <span class="st">"n"</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-28-1.png" width="624" style="display: block; margin: auto;"></p>
<p>The <em><code>fill</code></em> argument indicates the colors to use for filling the legend boxes beside the legend text. <em><code>border</code></em> is the border color of the legend boxes, and is used only if <em><code>fill</code></em> is specified. <em><code>title</code></em> adds a title at the top of the legend. Similar to when calling <code>plot</code>, <em><code>bty</code></em> indicates the type of box to be drawn around the legend (above, none).</p>
<p>We generally only want to specify <em><code>pch</code></em>, <em><code>fill</code></em>, or <em><code>lty</code></em> arguments. However, combining <em><code>pch</code></em> and <em><code>lty</code></em> can provide desireable results:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">y1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="fl">20</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">10</span>); <span class="no">y2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">5</span>, <span class="fl">15</span>, <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">10</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="fl">1</span>:<span class="fl">10</span>, <span class="no">y1</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"o"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">17</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="st">"dashed"</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="fl">1</span>:<span class="fl">10</span>, <span class="no">y2</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"o"</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">16</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="st">"dotted"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">2</span>,
       <span class="kw">y</span> <span class="kw">=</span> <span class="fl">15</span>,
       <span class="kw">xjust</span> <span class="kw">=</span> <span class="fl">0.5</span>,
       <span class="kw">legend</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>),
       <span class="kw">lty</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"dashed"</span>, <span class="st">"dotted"</span>),
       <span class="kw">pch</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">17</span>, <span class="fl">16</span>),
       <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="fl">2</span>, <span class="fl">15</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">3</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-29-1.png" width="624" style="display: block; margin: auto;"></p>
<p>The <em><code>ncol</code></em> argument indicates the number of columns in the legend items (by default R uses 1, a vertical legend). Setting <code>horiz = TRUE</code> will also make a horizontal legend without explicitly defining the number of columns. Analagous to text alignment, the <em><code>xjust</code></em> and <em><code>yjust</code></em> arguments determine how the legend is justified relative to the legend x and y locations. A value of 0 means left justified, 0.5 means centered and 1 means right justified.</p>
<p><code><a href="https://rdrr.io/r/graphics/legend.html">legend()</a></code> returns a nested list describing the location and size of the legend. The first element, <code>rect</code>, contains four elements: (1) <code>w</code> indicating the legend width, (2) <code>h</code> indicating the legend height, (3) <code>left</code> the x coordiante of the left edge, and (4) <code>top</code> the y coordinate of the top edge. The second element, <code>text</code>, contains two elements: (1) <code>x</code> giving the x coordinates of the “anchor” point for the text (in the order given by <em><code>legend</code></em>), and (2) <code>y</code> giving the y coordinates of the “anchor” point for the text. Like when using <code>text</code>, the <em><code>adj</code></em> parameter will define the alignment for the legend text.</p>
<p>We can also add a legend outside of the graph by setting <code>xpd = TRUE</code>.</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="co"># Add extra space to right of plot area; change clipping to figure</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">xpd</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">8.1</span>))
<span class="fu">irisScatter</span>()
<span class="no">lgnd1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"topright"</span>,
                <span class="kw">legend</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"setosa"</span>, <span class="st">"versicolor"</span>, <span class="st">"virginica"</span>),
                <span class="kw">title</span> <span class="kw">=</span> <span class="st">"Species"</span>,
                <span class="kw">text.col</span> <span class="kw">=</span> <span class="st">"transparent"</span>,
                <span class="kw">box.lty</span> <span class="kw">=</span> <span class="st">"dashed"</span>,
                <span class="kw">box.lwd</span> <span class="kw">=</span> <span class="fl">2</span>,
                <span class="kw">box.col</span> <span class="kw">=</span> <span class="st">"blue"</span>,
                <span class="kw">bg</span> <span class="kw">=</span> <span class="st">"transparent"</span>)
<span class="no">lgnd2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"topright"</span>,
                <span class="kw">legend</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"setosa"</span>, <span class="st">"versicolor"</span>, <span class="st">"virginica"</span>),
                <span class="kw">inset</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.3</span>, <span class="fl">0</span>),
                <span class="kw">col</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">3</span>,
                <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">16</span>,
                <span class="kw">title</span> <span class="kw">=</span> <span class="st">"lgnd2"</span>)
<span class="no">lgnd3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"topright"</span>,
                <span class="kw">legend</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"setosa"</span>, <span class="st">"versicolor"</span>, <span class="st">"virginica"</span>),
                <span class="kw">inset</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.2</span>, <span class="fl">0.4</span>),
                <span class="kw">col</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">3</span>,
                <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">16</span>,
                <span class="kw">title</span> <span class="kw">=</span> <span class="st">"lgnd3"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span>(<span class="kw">x0</span> <span class="kw">=</span> <span class="no">lgnd1</span>$<span class="no">rect</span>$<span class="no">left</span>,
       <span class="kw">x1</span> <span class="kw">=</span> <span class="no">lgnd1</span>$<span class="no">rect</span>$<span class="no">left</span> + <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="st">'usr'</span>)[<span class="fl">1</span>:<span class="fl">2</span>])*<span class="fl">0.3</span>,
       <span class="kw">y0</span> <span class="kw">=</span> <span class="no">lgnd1</span>$<span class="no">rect</span>$<span class="no">top</span>,
       <span class="kw">col</span> <span class="kw">=</span> <span class="st">"blue"</span>,
       <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span>(<span class="kw">x0</span> <span class="kw">=</span> <span class="no">lgnd1</span>$<span class="no">rect</span>$<span class="no">left</span>,
       <span class="kw">x1</span> <span class="kw">=</span> <span class="no">lgnd1</span>$<span class="no">rect</span>$<span class="no">left</span> - <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="st">'usr'</span>)[<span class="fl">1</span>:<span class="fl">2</span>])*<span class="fl">0.2</span>,
       <span class="kw">y0</span> <span class="kw">=</span> <span class="no">lgnd1</span>$<span class="no">rect</span>$<span class="no">top</span>,
       <span class="kw">y1</span> <span class="kw">=</span> <span class="no">lgnd1</span>$<span class="no">rect</span>$<span class="no">top</span> - <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="st">'usr'</span>)[<span class="fl">3</span>:<span class="fl">4</span>])*<span class="fl">0.4</span>,
       <span class="kw">col</span> <span class="kw">=</span> <span class="st">"blue"</span>,
       <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-30-1.png" width="624" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">lgnd1</span>$<span class="no">rect</span>$<span class="no">left</span> + <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="st">'usr'</span>)[<span class="fl">1</span>:<span class="fl">2</span>])*<span class="fl">0.3</span>
<span class="co">## [1] 8.168364</span>
<span class="no">lgnd2</span>
<span class="co">## $rect</span>
<span class="co">## $rect$w</span>
<span class="co">## [1] 1.042036</span>
<span class="co">## </span>
<span class="co">## $rect$h</span>
<span class="co">## [1] 1.740984</span>
<span class="co">## </span>
<span class="co">## $rect$left</span>
<span class="co">## [1] 8.168364</span>
<span class="co">## </span>
<span class="co">## $rect$top</span>
<span class="co">## [1] 7.136</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## $text</span>
<span class="co">## $text$x</span>
<span class="co">## [1] 8.455654 8.455654 8.455654</span>
<span class="co">## </span>
<span class="co">## $text$y</span>
<span class="co">## [1] 6.439607 6.091410 5.743213</span></pre></body></html></div>
<p>We could have also passed <code>xpd = TRUE</code> to <code>legend</code> and not changed the clipping for the whole figure. When specifying the legend location by keyword, <em><code>inset</code></em> defines how to position the legend with respect to the edge of the plotting region as a fraction of the plot region. Above, <code>inset = c(-0.3, 0)</code> says to position the legend to the right of the original x position by 0.3*(plot region width), given by <code>diff(par('usr')[1:2])*0.3</code>. The <code>diff</code> function just takes the difference of the given vector. Also notice the use of <em><code>text.col</code></em>, <em><code>box.lty</code></em>, and <em><code>box.col</code></em> in the first <code>legend</code> call above. As we might guess, these parameters define the text color, line type for the box, and color for the box, respectively. Also note, by default <code>bg = "white"</code>, meaning the legend will cover data. In the first legend call, we maintained the data underneath by setting <code>bg = "transparent"</code>. A complete list of parameters can be found in <code><a href="https://rdrr.io/r/graphics/legend.html">?legend</a></code>.</p>
</div>
<div id="other-objects" class="section level3">
<h3 class="hasAnchor">
<a href="#other-objects" class="anchor"></a>Other objects</h3>
<p>The following gives a mostly complete list of other the functions for drawing in the graphics system.</p>
<table class="table">
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>lines</code></td>
<td>Draw lines between the given coordinates</td>
</tr>
<tr class="even">
<td><code>polygon</code></td>
<td>Draw polygon with vertices at the given coordinates</td>
</tr>
<tr class="odd">
<td><code>abline</code></td>
<td>Draw lines according to <span class="math inline">\(y = bx + a\)</span>
</td>
</tr>
<tr class="even">
<td><code>arrows</code></td>
<td>Draw lines with arrow heads</td>
</tr>
<tr class="odd">
<td><code>curve</code></td>
<td>Draw the given expression</td>
</tr>
<tr class="even">
<td><code>segments</code></td>
<td>Draw segments between the given pairs of points</td>
</tr>
</tbody>
</table>
</div>
<div id="colors" class="section level3">
<h3 class="hasAnchor">
<a href="#colors" class="anchor"></a>Colors</h3>
<p>In this section, we will briefly talk about the color basics, and then introduce a couple of popular and useful color packages that generate sets of colors. First, we will explore the colors built into R. R recognizes 657 named colors which are returned by the <code><a href="https://rdrr.io/r/grDevices/colors.html">colors()</a></code> (or <code><a href="https://rdrr.io/r/grDevices/colors.html">colours()</a></code>) function.</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/colors.html">colors</a></span>())
<span class="co">## [1] "white"         "aliceblue"     "antiquewhite"  "antiquewhite1"</span>
<span class="co">## [5] "antiquewhite2" "antiquewhite3"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/colors.html">colors</a></span>())
<span class="co">## [1] "yellow"      "yellow1"     "yellow2"     "yellow3"     "yellow4"    </span>
<span class="co">## [6] "yellowgreen"</span></pre></body></html></div>
<p>Using the named colors is the easiest ways to specify a color in R. An excellent reference for color names: <a href="http://research.stowers.org/mcm/efg/R/Color/Chart/ColorChart.pdf" class="uri">http://research.stowers.org/mcm/efg/R/Color/Chart/ColorChart.pdf</a></p>
<p>What about other ways to specify colors? In addition to the named colors, R accepts hexadecimal colors of the form “#RRGGBB” where each pair “RR”, “GG”, and “BB” consist of two hexadecimal digits giving a value in the range zero (00) to 255 (FF). The “RR”, “GG”, and “BB” refer to color intensity in the red, green, and blue channels, respectively. R provides two functions, (1) <code><a href="https://rdrr.io/r/grDevices/rgb.html">rgb()</a></code> and (2) <code><a href="https://rdrr.io/r/grDevices/col2rgb.html">col2rgb()</a></code> to work with the red-green-blue scale. By default, <code>rgb</code> returns the hexadecimal color based on the given red, green, and blue scales from 0 to 1. <code>rgb</code> will take values from 0 to 255 if we specify <em><code>maxColorValue = 255</code></em>. <code>col2rgb</code> takes either an integer or named color and returns the rgb values from 0 to 255. Unfortunately, these functions do not play nice together.</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="kw">red</span> <span class="kw">=</span> <span class="fl">255</span>, <span class="kw">green</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">blue</span> <span class="kw">=</span> <span class="fl">0</span>, <span class="kw">maxColorValue</span> <span class="kw">=</span> <span class="fl">255</span>)
<span class="co">## [1] "#FF0000"</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/col2rgb.html">col2rgb</a></span>(<span class="st">"red"</span>)
<span class="co">##       [,1]</span>
<span class="co">## red    255</span>
<span class="co">## green    0</span>
<span class="co">## blue     0</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/col2rgb.html">col2rgb</a></span>(<span class="fl">2</span>)
<span class="co">##       [,1]</span>
<span class="co">## red    223</span>
<span class="co">## green   83</span>
<span class="co">## blue   107</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/col2rgb.html">col2rgb</a></span>(<span class="fl">1</span>:<span class="fl">8</span>)
<span class="co">##       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]</span>
<span class="co">## red      0  223   97   34   40  205  245  158</span>
<span class="co">## green    0   83  208  151  226   11  199  158</span>
<span class="co">## blue     0  107   79  230  229  188   16  158</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/col2rgb.html">col2rgb</a></span>(<span class="fl">1</span>:<span class="fl">8</span>)), <span class="kw">maxColorValue</span> <span class="kw">=</span> <span class="fl">255</span>) <span class="co"># rgb will take a matrix, but </span>
<span class="co">## [1] "#000000" "#DF536B" "#61D04F" "#2297E6" "#28E2E5" "#CD0BBC" "#F5C710"</span>
<span class="co">## [8] "#9E9E9E"</span></pre></body></html></div>
<p>Notice that <code>col2rgb</code> returns an RGB by input matrix, but <code>rgb</code> requires an input by RGB matrix. The RGB color model corresponds to color generation on a computer screen rather than human color perception, and it is virtually impossible for humans to control the perceptual properties of a color in this color space. R also provides the <code>hcl</code> function to specify colors in the hue-chroma-luminance model, which can be more intuitive.</p>
<p>By default, R has a palette of colors, returned by the <code>palette</code> function. We can specify colors by integer, giving the index in the current palette. Note, these colors are repeated if the integer given is greater than the size of the palette. One final way to specify a color is to index an integer into a predefined set of colors using the <code><a href="https://rdrr.io/r/grDevices/palette.html">palette()</a></code> function:</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html">palette</a></span>()
<span class="co">## [1] "black"   "#DF536B" "#61D04F" "#2297E6" "#28E2E5" "#CD0BBC" "#F5C710"</span>
<span class="co">## [8] "gray62"</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0.5</span>, <span class="fl">4</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>, <span class="fl">8</span>), <span class="kw">col</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">8</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-34-1.png" width="576" style="display: block; margin: auto;"></p>
<p>We can also change the palette using <code>palette</code>:</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html">palette</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">8</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0.5</span>, <span class="fl">4</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>, <span class="fl">8</span>), <span class="kw">col</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">8</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-35-1.png" width="576" style="display: block; margin: auto;"></p>
<p><code>rainbow</code> is a built in color ramping function. R has two types of color ramping functions: (1) a function that takes values between 0 and 1 and returns a matrix of RGB values, used less often and (2) a function that takes an integer, n, and returns n hexadecimal colors. <code>rainbow</code> is the second type. Below we see we can specify 100 colors, and <code>rainbow</code> will return 100 colors equally spaced along ROY-G-BIV.</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html">palette</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">100</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0.5</span>, <span class="fl">4</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>, <span class="fl">100</span>), <span class="kw">col</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">100</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-36-1.png" width="576" style="display: block; margin: auto;"></p>
<p>R provides two functions for creating custom palettes. For type (1) we can use <code>colorRamp</code>, and for type (2) we can use <code>colorRampPalette</code>. These functions return functions, that we will store and use. Here, we will create a blue-gray-red “diverging” palette.</p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="no">cbrhPal</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"blue3"</span>, <span class="st">"gray80"</span>, <span class="st">"red3"</span>), <span class="kw">bias</span> <span class="kw">=</span> <span class="fl">0.5</span>)
<span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html">palette</a></span>(<span class="fu">cbrhPal</span>(<span class="fl">30</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0.5</span>, <span class="fl">4</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>, <span class="fl">60</span>), <span class="kw">col</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">60</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-37-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Note the <em><code>bias</code></em> parameter changes the palette center, which would be grey at the default <em><code>bias</code></em> value of 1. Also note, the palette will recycle when the integer values exceed the number of unique colors in the palette. Creating custom palettes can be daunting. We suggest using the <a href="https://cran.r-project.org/web/packages/RColorBrewer/index.html">RColorBrewer</a> and <a href="https://cran.r-project.org/web/packages/colorspace/">colorspace</a> packages, which both provide functionality for creating visually appealing and colorblind-safe palettes. More information about the packages is available as a supplemental vignette in this package called “palettes”.</p>
<p>We yield to Edward Tufte for some final thoughts on using color in visualizing data<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>.</p>
<blockquote>
<p>The fundamental uses of color in information design (are): to label, to measure, to represent or imitate reality, to enliven or decorate.</p>
</blockquote>
<blockquote>
<p>Color spots against a light gray or muted field highlight and italicize data. Note the effectiveness and elegance of small spots of intense, saturated color for carrying information.</p>
</blockquote>
<blockquote>
<p>Use colors found in nature, especially those on the lighter side.</p>
</blockquote>
<blockquote>
<p>For encoding information, more than 20 or 30 colors frequently produce not diminishing but negative returns.</p>
</blockquote>
<blockquote>
<p>The primary colors (yellow, red, blue) and black provides maximum differentiation (no four colors differ more).</p>
</blockquote>
<blockquote>
<p>In color maps, use a single hue… Using a single hue with variations in intensity allows instant interpretation, multiple color maps without ambiguity, and leaves graphical space for layering and separation.</p>
</blockquote>
</div>
<div id="organizing-multiple-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#organizing-multiple-plots" class="anchor"></a>Organizing multiple plots</h3>
<p>The graphics system provides three ways of organzing multiple plots in one device. The first way is the <em><code>mfrow</code></em> or <em><code>mfcol</code></em> parameter in <code>par</code>. The <em><code>mfrow</code></em>/<em><code>mfcol</code></em> parameters take a length two vector defining the number of rows and columns (<code>[nrow, ncol]</code>) to create a grid of plots.</p>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">2</span>), <span class="kw">oma</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">1</span>), <span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>))
<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="fl">1</span>:<span class="fl">4</span>)) {
  <span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="no">i</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">3</span>)
  <span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">which</span> <span class="kw">=</span> <span class="st">"figure"</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"darkred"</span>)
  <span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"gray40"</span>)
  <span class="fu"><a href="../reference/labelLines.html">labelLines</a></span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.5</span>)
}
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">which</span> <span class="kw">=</span> <span class="st">"inner"</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"darkblue"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">which</span> <span class="kw">=</span> <span class="st">"outer"</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"darkgreen"</span>)
<span class="fu"><a href="../reference/labelLines.html">labelLines</a></span>(<span class="kw">outer</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.5</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-38-1.png" width="624" style="display: block; margin: auto;"></p>
<p>Rerun the above chunk changing <code>mfrow = c(2, 2)</code> to <code>mfcol = c(2, 2)</code> to note the difference. Note the use of “inner”. The “inner” region is drawing region defined by the sum of the figure regions (or NOT the outer region). The inner region will equal the figure region when there is only one plot in a device.</p>
<p>The second way to organize multiple plots in the graphics engine is the <code>layout</code> function. <code>layout</code> takes a matrix of integers specifying the plot to occupy the cell in the matrix. It also allows users to specify the heights and widths of the rows and columns. For example:</p>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>(<span class="kw">mat</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span>), <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>), <span class="kw">heights</span> <span class="kw">=</span> <span class="fl">2</span>:<span class="fl">1</span>, <span class="kw">widths</span> <span class="kw">=</span> <span class="fl">2</span>:<span class="fl">1</span>)
<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="fl">1</span>:<span class="fl">3</span>)) {
  <span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="no">i</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">3</span>)
  <span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">which</span> <span class="kw">=</span> <span class="st">"figure"</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"darkred"</span>)
  <span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"gray40"</span>)
  <span class="fu"><a href="../reference/labelLines.html">labelLines</a></span>(<span class="kw">alpha</span> <span class="kw">=</span> <span class="fl">0.5</span>)
}</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-39-1.png" width="624" style="display: block; margin: auto;"></p>
<p>Finally, consider how layout can be used to overlay plots. (However, when constructing complicated overlaying plots it would be best to use the grid engine that is not discussed in this course.)</p>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>(<span class="kw">mat</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>), <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>), <span class="kw">heights</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="fl">4</span>))
<span class="co"># First plot</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="st">"1"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">24</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red2"</span>)
<span class="co"># Second plot</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="kw">lwd</span> <span class="kw">=</span> <span class="fl">40</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"blue"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="fl">1</span>, <span class="fl">1</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="st">"2"</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"white"</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-40-1.png" width="624" style="display: block; margin: auto;"></p>
<p>Notice how changing the numbers in the matrix specifies the order of the drawing. In the example above the white line drawn during the second plot draws over the red box drawn in the first. The third way to organize multiple plots is with the <code>screen</code> functions (<code><a href="https://rdrr.io/r/graphics/screen.html">?screen</a></code>), but they are more complicated than layout and are rarely (if ever) necessary.</p>
</div>
<div id="coordinate-systems" class="section level3">
<h3 class="hasAnchor">
<a href="#coordinate-systems" class="anchor"></a>Coordinate systems</h3>
<p>There are multiple coordinate systems used by the graphics system, listed in the table below.</p>
<table class="table">
<colgroup>
<col width="12%">
<col width="87%">
</colgroup>
<thead><tr class="header">
<th>Name</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>“user”</td>
<td>Most commonly used, the xy coordinates defined by the plotting region</td>
</tr>
<tr class="even">
<td>“inches”</td>
<td>Cooridnates in inches with (0, 0) at bottom left of the device</td>
</tr>
<tr class="odd">
<td>“device”</td>
<td>Cooridnates in pixels or 1/72 inches with (0, 0) at top left of the device</td>
</tr>
<tr class="even">
<td>“ndc”</td>
<td>Normalized device coordinates with (0, 0) at bottom left of the device</td>
</tr>
<tr class="odd">
<td>“nfc”</td>
<td>Normalized figure coordinates with (0, 0) at bottom left of the figure</td>
</tr>
<tr class="even">
<td>“npc”</td>
<td>Normalized plot coordinates with (0, 0) at bottom left of the plot</td>
</tr>
<tr class="odd">
<td>“nic”</td>
<td>Normalized inner coordinates with (0, 0) at bottom left of the inner region</td>
</tr>
</tbody>
</table>
<p>We can convert x and y values between the different coordinate systems using the <code>grconvertX</code> and <code>grconvertY</code> functions, respectively. Note, for drawings with a single plotting region and no outer margins ‘ndc’, ‘nfc’ and ‘nic’ are identical. The following example comes from the R documentation for <code>grconvertX</code>:</p>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="fl">1</span>:<span class="fl">4</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-41-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb37"><html><body><pre class="r"><span class="kw">for</span>(<span class="no">tp</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"inches"</span>, <span class="st">"device"</span>, <span class="st">"ndc"</span>, <span class="st">"nfc"</span>, <span class="st">"npc"</span>, <span class="st">"nic"</span>)) {
  <span class="no">newX</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/convertXY.html">grconvertX</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.0</span>, <span class="fl">4.0</span>), <span class="st">"user"</span>, <span class="no">tp</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="no">tp</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">newX</span>, <span class="fl">3</span>), <span class="kw">collapse</span> <span class="kw">=</span> <span class="st">", "</span>), <span class="kw">sep</span> <span class="kw">=</span> <span class="st">": "</span>))
}
<span class="co">## [1] "inches: 0.996, 5.404"</span>
<span class="co">## [1] "device: 71.733, 389.067"</span>
<span class="co">## [1] "ndc: 0.166, 0.901"</span>
<span class="co">## [1] "nfc: 0.166, 0.901"</span>
<span class="co">## [1] "npc: 0.037, 0.963"</span>
<span class="co">## [1] "nic: 0.166, 0.901"</span></pre></body></html></div>
<p>If we add another plotting region and outer margins the values change.</p>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">oma</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">1</span>), <span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>))
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="fl">1</span>:<span class="fl">4</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-42-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb39"><html><body><pre class="r"><span class="kw">for</span>(<span class="no">tp</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"inches"</span>, <span class="st">"device"</span>, <span class="st">"ndc"</span>, <span class="st">"nfc"</span>, <span class="st">"npc"</span>, <span class="st">"nic"</span>)) {
  <span class="no">newX</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/convertXY.html">grconvertX</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.0</span>, <span class="fl">4.0</span>), <span class="st">"user"</span>, <span class="no">tp</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="no">tp</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">newX</span>, <span class="fl">3</span>), <span class="kw">collapse</span> <span class="kw">=</span> <span class="st">", "</span>), <span class="kw">sep</span> <span class="kw">=</span> <span class="st">": "</span>))
}
<span class="co">## [1] "inches: 1.102, 3.144"</span>
<span class="co">## [1] "device: 79.322, 226.378"</span>
<span class="co">## [1] "ndc: 0.151, 0.431"</span>
<span class="co">## [1] "nfc: 0.262, 0.854"</span>
<span class="co">## [1] "npc: 0.037, 0.963"</span>
<span class="co">## [1] "nic: 0.131, 0.427"</span></pre></body></html></div>
<p>For the above plot, consider the locations of (0, 0) and (1, 1) is in each of the cooridnate systems.</p>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">oma</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">1</span>), <span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">2</span>))
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="fl">1</span>:<span class="fl">4</span>, <span class="kw">ann</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">axes</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"n"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">col</span> <span class="kw">=</span> <span class="st">"gray40"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">which</span> <span class="kw">=</span> <span class="st">"figure"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"darkred"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">which</span> <span class="kw">=</span> <span class="st">"inner"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"darkblue"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/box.html">box</a></span>(<span class="kw">which</span> <span class="kw">=</span> <span class="st">"outer"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"darkgreen"</span>)
<span class="kw">for</span>(<span class="no">tp</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"inches"</span>, <span class="st">"device"</span>, <span class="st">"ndc"</span>, <span class="st">"nfc"</span>, <span class="st">"npc"</span>, <span class="st">"nic"</span>)) {
  <span class="no">mcol</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/switch.html">switch</a></span>(<span class="no">tp</span>,
                 <span class="kw">`in`</span> <span class="kw">=</span> <span class="st">"darkorange2"</span>,
                 <span class="kw">`dev`</span> <span class="kw">=</span> <span class="st">"purple3"</span>,
                 <span class="kw">`ndc`</span> <span class="kw">=</span> <span class="st">"darkgreen"</span>,
                 <span class="kw">`nfc`</span> <span class="kw">=</span> <span class="st">"darkred"</span>,
                 <span class="kw">`npc`</span> <span class="kw">=</span> <span class="st">"gray40"</span>,
                 <span class="kw">`nic`</span> <span class="kw">=</span> <span class="st">"darkblue"</span>)
  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/convertXY.html">grconvertX</a></span>(<span class="fl">0</span>:<span class="fl">1</span>, <span class="no">tp</span>, <span class="st">"user"</span>),
        <span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/convertXY.html">grconvertY</a></span>(<span class="fl">0</span>:<span class="fl">1</span>, <span class="no">tp</span>, <span class="st">"user"</span>),
        <span class="kw">col</span> <span class="kw">=</span> <span class="no">mcol</span>, <span class="kw">cex</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">xpd</span> <span class="kw">=</span> <span class="fl">NA</span>, <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">16</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"o"</span>, <span class="kw">lty</span> <span class="kw">=</span> <span class="st">"dashed"</span>)
}</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-44-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Consider the following example, where we determine the line location in user cooridnates. Recall, the size of the inner and outer margins are defined by the number of lines on each side of the plotting/figure regions, respectively. The number lines, here, refers to the number of lines of text that will fit. We can get the text height using the <em><code>cin</code></em>, <em><code>cex</code></em>, and <em><code>lheight</code></em> parameters stored in <code>par</code>. <em><code>cin</code></em> is a length two vector, defining the width and height (<code>[width, height]</code>) of a character in inches. <em><code>cex</code></em> provides the size multiplier. <em><code>lheight</code></em> defines the line height multiplier, or the spacing between lines of text. Therefore, we can get the height of a line (in inches) by multiplying the values:</p>
<div class="sourceCode" id="cb41"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/frame.html">plot.new</a></span>()
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="st">'cin'</span>)[<span class="fl">2</span>]*<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="st">'cex'</span>)*<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="st">'lheight'</span>)
<span class="co">## [1] 0.2</span></pre></body></html></div>
<p>We can then convert that line height to ‘npc’ units, and finally to ‘user’ units. (Note: using ‘user’ units becomes problematic if you have an axis on log scale because the ‘user’ coordinates are not linear.) The following function illustrates how:</p>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="no">line2user</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">line</span>, <span class="no">side</span>) {
  <span class="no">lH</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="st">'cin'</span>)[<span class="fl">2</span>] * <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="st">'cex'</span>) * <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="st">'lheight'</span>) <span class="co"># Get the line height (in)</span>
  <span class="co"># Converting to npc requires taking the difference between 0 and lh, because</span>
  <span class="co"># 0 in inches does not equal 0 in npc</span>
  <span class="no">xOff</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="fu"><a href="https://rdrr.io/r/graphics/convertXY.html">grconvertX</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="no">lH</span>), <span class="st">'inches'</span>, <span class="st">'npc'</span>)) <span class="co"># Convert to npc for x</span>
  <span class="no">yOff</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="fu"><a href="https://rdrr.io/r/graphics/convertXY.html">grconvertY</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="no">lH</span>), <span class="st">'inches'</span>, <span class="st">'npc'</span>)) <span class="co"># Convert to npc for y</span>
  <span class="fu"><a href="https://rdrr.io/r/base/switch.html">switch</a></span>(<span class="no">side</span>,
         <span class="kw">`1`</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/convertXY.html">grconvertY</a></span>(-<span class="no">line</span>*<span class="no">yOff</span>, <span class="st">'npc'</span>, <span class="st">'user'</span>),
         <span class="kw">`2`</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/convertXY.html">grconvertX</a></span>(-<span class="no">line</span>*<span class="no">xOff</span>, <span class="st">'npc'</span>, <span class="st">'user'</span>),
         <span class="kw">`3`</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/convertXY.html">grconvertY</a></span>(<span class="fl">1</span> + <span class="no">line</span>*<span class="no">yOff</span>, <span class="st">'npc'</span>, <span class="st">'user'</span>),
         <span class="kw">`4`</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/convertXY.html">grconvertX</a></span>(<span class="fl">1</span> + <span class="no">line</span>*<span class="no">xOff</span>, <span class="st">'npc'</span>, <span class="st">'user'</span>),
         <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"Side must be 1, 2, 3, or 4"</span>, <span class="kw">call.</span><span class="kw">=</span><span class="fl">FALSE</span>))
}</pre></body></html></div>
</div>
<div id="common-plotting-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#common-plotting-functions" class="anchor"></a>Common plotting functions</h3>
<p>Plots in R base plotting system are generated by calling successive R functions to “build” a plot. The graphics engine provides many convenience functions for common plots, enabling a simpler starting point for some graphs.</p>
<ol style="list-style-type: decimal">
<li>
<p>Histograms</p>
<p>A histogram displays the frequencies of data points occurring in defined ranges. Here is an example of a simple histogram made using the <code>hist</code> function.</p>
<div class="sourceCode" id="cb43"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">iris</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">iris</span>$<span class="no">Sepal.Length</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Distribution of Sepal Length"</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Sepal Length"</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-47-1.png" width="624" style="display: block; margin: auto;"></p>
<p>R automatically calculates the intervals to use in the plot, but there are many ways to set the breakpoints. You can specify the number of breaks using the <em><code>breaks</code></em> argument. Here we look at the histograms with different numbers of breaks:</p>
<div class="sourceCode" id="cb44"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">iris</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">2</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">iris</span>$<span class="no">Sepal.Length</span>, <span class="kw">breaks</span> <span class="kw">=</span> <span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">iris</span>$<span class="no">Sepal.Length</span>, <span class="kw">breaks</span> <span class="kw">=</span> <span class="fl">10</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">iris</span>$<span class="no">Sepal.Length</span>, <span class="kw">breaks</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">freq</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">iris</span>$<span class="no">Sepal.Length</span>, <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>, <span class="fl">4.5</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">7.2</span>, <span class="fl">7.6</span>, <span class="fl">8</span>), <span class="kw">freq</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">## Warning in plot.histogram(r, freq = freq1, col = col, border = border, angle =</span>
<span class="co">## angle, : the AREAS in the plot are wrong -- rather use 'freq = FALSE'</span></pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-48-1.png" width="624" style="display: block; margin: auto;"></p>
<p>We see <em><code>breaks</code></em> can also take a vector of user-specified breaks. In the case of uneven breaks <em><code>freq</code></em> defaults to <code>FALSE</code>, indicating to plot the density values (rather than frequency/count). This can be coerced back to count by setting <code>freq = TRUE</code> in the function call.</p>
</li>
<li>
<p>Barplot</p>
<p>A barplot is another common type of graphics and it plots the relationship between a numeric variable and a categorical variable. For example, sometimes we need to plot the count of each item as bar plots from a categorical dataset. You can use a base R function <code>barplot</code> to make a barplot. The input data is a numeric vector, which gives the height of the bars.</p>
<div class="sourceCode" id="cb45"><html><body><pre class="r"><span class="co"># count the number of species in the iris dataset using the table() function</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">iris</span>)
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">iris</span>$<span class="no">Species</span>)
<span class="co">## </span>
<span class="co">##     setosa versicolor  virginica </span>
<span class="co">##         50         50         50</span>
<span class="co"># reset the color palette</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html">palette</a></span>(<span class="st">"default"</span>)
<span class="co"># plot this count data</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">iris</span>$<span class="no">Species</span>), <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Count of Species"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fl">3</span>),
        <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Species"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Count"</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-49-1.png" width="624" style="display: block; margin: auto;"></p>
</li>
<li>
<p>Boxplot</p>
<p>A boxplot provides a way of displaying the distribution of data based on the median, quartiles, minimum and maximum. You can make a boxplot using the <code>boxplot</code> function, which takes its first argument as a formula. Here, the formula has a form of <code>y-axis ~ x-axis</code>. We are plotting sepal length by species, and the right hand side of the <code>~</code> indicates the species variable.</p>
<div class="sourceCode" id="cb46"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="no">iris</span>$<span class="no">Sepal.Length</span> ~ <span class="no">iris</span>$<span class="no">Species</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Species"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Sepal Length"</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-50-1.png" width="624" style="display: block; margin: auto;"></p>
<p>Each boxplot shows the median (the line inside the box), <span class="math inline">\(25^{th}\)</span> and <span class="math inline">\(75^{th}\)</span> percentiles of the data (the “box”), as well as +/- 1.5 times the interquartile range (IQR) of the data (the “whiskers”). Data points that are beyond 1.5 times the IQR of the data are represented separately by the circles.</p>
</li>
<li>
<p>Paired scatterplots</p>
<p>A scatterplot provides a way to visualize the relationship between two sets of numbers. In the ‘Iris’ dataset, we have four variables for observation: sepal length, sepal width, petal length, and petal width. We can look at the relationship between any of the four variables using <code>plot</code>, or we can look at all pairs of relationships using the <code>pairs</code> function:</p>
<div class="sourceCode" id="cb47"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span>(<span class="no">iris</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="no">iris</span>$<span class="no">Species</span>)</pre></body></html></div>
<p><img src="graphics_files/figure-html/unnamed-chunk-51-1.png" width="624" style="display: block; margin: auto;"></p>
</li>
</ol>
</div>
<div id="exercises" class="section level3">
<h3 class="hasAnchor">
<a href="#exercises" class="anchor"></a>Exercises</h3>
<ol style="list-style-type: decimal">
<li>
<p>Recreate the following graph of <code>AAPL</code> below. (<code>AAPL</code> can be loaded by running <code><a href="https://rdrr.io/r/utils/data.html">data(APPL)</a></code>). The color used for shading is “dodgerblue”. Hint: the <code>plot</code> function will convert the dates to numeric. Take a look at <code><a href="https://rdrr.io/r/base/as.Date.html">?as.Date</a></code> and try running <code><a href="https://rdrr.io/r/base/numeric.html">as.numeric(AAPL$date)</a></code>. You can create the plot without explicilty using the “date” class.</p>
<p><img src="graphics_files/figure-html/unnamed-chunk-53-1.png" width="624" style="display: block; margin: auto;"></p>
</li>
<li>
<p>Create a ruler with your hand length (from bottom of palm to longest finger tip) in inches rounded to the nearest quarter inch. The ruler should be 2 inches tall, have an outer border, have dashes from inch down to sixteenth inch with the height of the dash corresponding to the unit (eg. the quater inch dashes should be 1/4" tall), have the inch marks labeled above the lines, and have your name (eg. “Dayne’s Ruler”) centered at 1.5" above the bottom of the ruler. See the example below.</p>
<p><img src="graphics_files/figure-html/unnamed-chunk-54-1.png" width="624" style="display: block; margin: auto;"></p>
</li>
<li><p>Challenge question: modify the <code>line2user</code> function with an <em><code>outer</code></em> parameter such that the function will return the correct position of the outer lines (in user coordinates for the current plot) despite the number of plots in the device region. Hint: think about where the outer lines start relative to the different drawing regions.</p></li>
</ol>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p><a href="http://rgraphics.limnology.wisc.edu/pch.php" class="uri">http://rgraphics.limnology.wisc.edu/pch.php</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Edward Tufte. <em>The Visual Display of Quantitative Information and Envisioning Information</em>, Graphics Press, PO Box 430, Cheshire, CT 06410.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Dayne L Filer, Amy Pomeroy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
