<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HTLTC-R: Functions • htltcR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="HTLTC-R: Functions">
<meta property="og:description" content="htltcR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">htltcR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/control.html">HTLTC-R: Control statements</a>
    </li>
    <li>
      <a href="../articles/functions.html">HTLTC-R: Functions</a>
    </li>
    <li>
      <a href="../articles/graphics.html">HTLTC-R: Graphics</a>
    </li>
    <li>
      <a href="../articles/io.html">HTLTC-R: Reading, writing, and regular expressions</a>
    </li>
    <li>
      <a href="../articles/operators.html">HTLTC-R: Operators</a>
    </li>
    <li>
      <a href="../articles/package.html">HTLTC-R: Reproducible research &amp; packages</a>
    </li>
    <li>
      <a href="../articles/palettes.html">HTLTC-R: Color packages</a>
    </li>
    <li>
      <a href="../articles/plotting-ggplot.html">HTLTC-R: Plotting with ggplot2</a>
    </li>
    <li>
      <a href="../articles/plotting.html">HTLTC-R: Plotting</a>
    </li>
    <li>
      <a href="../articles/structures.html">HTLTC-R: Data structures &amp; subsetting</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>HTLTC-R: Functions</h1>
            
      
      
      <div class="hidden name"><code>functions.Rmd</code></div>

    </div>

    
    
<div id="using-this-document" class="section level3">
<h3 class="hasAnchor">
<a href="#using-this-document" class="anchor"></a>Using this document</h3>
<ul>
<li>Code blocks and R code have a grey background (note, code nested in the text is not highlighted in the pdf version of this document but is a different font).</li>
<li># indicates a comment, and anything after a comment will not be evaluated in R</li>
<li>The comments beginning with ## under the code in the grey code boxes are the output from the code directly above; any comments added by us will start with a single #</li>
<li>While you can copy and paste code into R, you will learn faster if you type out the commands yourself.</li>
<li>Read through the document after class. This is meant to be a reference, and ideally, you should be able to understand every line of code. If there is something you do not understand please email us with questions or ask in the following class (you’re probably not the only one with the same question!).</li>
</ul>
</div>
<div id="goals" class="section level3">
<h3 class="hasAnchor">
<a href="#goals" class="anchor"></a>Goals</h3>
<ol style="list-style-type: decimal">
<li>Write and run a basic function in R</li>
<li>Understand function environments and how functions find things</li>
<li>Apply the “do not repeat yourself” (DRY) principle</li>
</ol>
</div>
<div id="basic-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-functions" class="anchor"></a>Basic functions</h3>
<p>So far we’ve used a lot of functions that already exist in R. Now you will learn how to write your own functions. User-written functions take the following structure:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r">myfunction &lt;- function(arg1, arg2, ...) {
  
  do some stuff
  return(object)
  
}</pre></body></html></div>
<p>Make a simple function that just returns the arument that it is given.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">first_function</span> <span class="kw">&lt;-</span> <span class="kw">function</span> (<span class="no">x</span>) {

  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">x</span>)

}</pre></body></html></div>
<p>Now if you pass a value to <code>first_function</code> it should return that value:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu">first_function</span>(<span class="fl">9</span>)
<span class="co">## [1] 9</span></pre></body></html></div>
<p>A function that only returns the given value is not useful, but it does illustrate how you can add functions to your environment. Now make a function that squares a value and then adds one to it.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">second_function</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) {

  <span class="no">ans</span> <span class="kw">&lt;-</span> <span class="no">x</span>^<span class="fl">2</span> + <span class="fl">1</span>
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">ans</span>)

}
<span class="fu">second_function</span>(<span class="fl">9</span>)
<span class="co">## [1] 82</span></pre></body></html></div>
</div>
<div id="the-function-environment" class="section level3">
<h3 class="hasAnchor">
<a href="#the-function-environment" class="anchor"></a>The function environment</h3>
<p>An environment is a place to store variables. As we discussed in class 1, when you make assignments in R, they are generally added as entries to the global environment.</p>
<p>Functions are evaluated in their own environments. When a function is called a new environment is created. This new environment is called the evaluation environment. Functions also have an enclosing environment, which is the environment where the function was defined. For a functions defined in the workspace the enclosing environment is the global envrionment.</p>
<p>When a function is evaluated, R looks through a series of environments for variables called. It first searches the evaluation environment and then the enclosing environment. This means that a global variable can be referenced inside a function. This principle is shown below by <code>third_function</code> which sums the argument <code>x</code> with the variable <code>a</code> from the global environment.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">a</span> <span class="kw">&lt;-</span> <span class="fl">9</span>
<span class="no">third_function</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) { <span class="no">x</span> + <span class="no">a</span> }
<span class="fu">third_function</span>(<span class="fl">11</span>)
<span class="co">## [1] 20</span></pre></body></html></div>
<p>The evaluation environment is populated with local variables as the evaluation of the function procedes. Once the function completes running, the evaluation environment is destroyed. Look at <code>second_function</code> for example. Within the function the variable <code>ans</code> is assigned. However, when you evaluate the function the <code>ans</code> variable is not available the global environment because it was assigned in the evaluation environment, and the evaluation environment was destroyed after the function completed.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu">second_function</span>(<span class="fl">9</span>)
<span class="co">## [1] 82</span>
<span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span>()
<span class="co">## [1] "a"               "first_function"  "second_function" "third_function"</span></pre></body></html></div>
<p>As you can see, listing objects in the global environment only returns the global variable <code>a</code> assigned previously and the three functions that you have defined so far.</p>
</div>
<div id="dry-principle" class="section level3">
<h3 class="hasAnchor">
<a href="#dry-principle" class="anchor"></a>DRY principle</h3>
<p>The don’t repeat yourself (DRY) principle states that</p>
<blockquote>
<p>every piece of knowledge must have a single, unambigous, authorative representation within a system - Dave Thomas and Andy Hunt.</p>
</blockquote>
<p>There is a lot to think about when using the DRY principle, like not repeating variable names throughout your code. The DRY principle is particularly useful when thinking about functional programming. If you find yourself writing the same code more than once, or copying and pasting, consider writing a function. Think back to the primer list discussed in last class, and consider the following code to generate random primers:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">bases</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'A'</span>, <span class="st">'T'</span>, <span class="st">'C'</span>, <span class="st">'G'</span>)
<span class="no">l1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">15</span>:<span class="fl">35</span>, <span class="fl">25</span>, <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">p1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span>(<span class="kw">length</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">l1</span>))
<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p1</span>)) {
  <span class="no">p1</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="no">bases</span>, <span class="no">l1</span>[<span class="no">i</span>], <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>), <span class="kw">collapse</span> <span class="kw">=</span> <span class="st">""</span>)
}
<span class="no">l2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">15</span>:<span class="fl">35</span>, <span class="fl">25</span>, <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">p2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span>(<span class="kw">length</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">l2</span>))
<span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p2</span>)) {
  <span class="no">p2</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="no">bases</span>, <span class="no">l2</span>[<span class="no">i</span>], <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>), <span class="kw">collapse</span> <span class="kw">=</span> <span class="st">""</span>)
}</pre></body></html></div>
<p>Now imagine you have to create 100 sets of primers. After you fininsh you realize you need to change the list of possible primer lengths. If you wrote code like above you would have to edit each line. Notice how similar the code is to generate the two sets of primers above. You may see how the code above could be functionalized. Consider what may be variable in the code above, and create a function parameter for each variable part of the code. You may wish to change the minimum primer length, the maximum primer length, the number of primers in each list, and even the possible bases.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="co"># Create a funciton to primer lists. </span>
<span class="no">genPrimer</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">minlen</span>, <span class="no">maxlen</span>, <span class="no">nprimers</span>, <span class="no">bases</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'A'</span>, <span class="st">'T'</span>, <span class="st">'C'</span>, <span class="st">'G'</span>)) {

  <span class="no">l</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="no">minlen</span>:<span class="no">maxlen</span>, <span class="no">nprimers</span>, <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
  <span class="no">p</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span>(<span class="kw">length</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">l</span>))
  <span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">p</span>)) {
    <span class="no">p</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="no">bases</span>, <span class="no">l</span>[<span class="no">i</span>], <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>), <span class="kw">collapse</span> <span class="kw">=</span> <span class="st">""</span>)
  }
  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">primers</span> <span class="kw">=</span> <span class="no">p</span>, <span class="kw">lengths</span> <span class="kw">=</span> <span class="no">l</span>))

}
<span class="no">primers1</span> <span class="kw">&lt;-</span> <span class="fu">genPrimer</span>(<span class="kw">minlen</span> <span class="kw">=</span> <span class="fl">15</span>, <span class="kw">maxlen</span> <span class="kw">=</span> <span class="fl">35</span>, <span class="kw">nprimers</span> <span class="kw">=</span> <span class="fl">25</span>)
<span class="no">primers2</span> <span class="kw">&lt;-</span> <span class="fu">genPrimer</span>(<span class="kw">minlen</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">maxlen</span> <span class="kw">=</span> <span class="fl">40</span>, <span class="kw">nprimers</span> <span class="kw">=</span> <span class="fl">25</span>)</pre></body></html></div>
<p>Notice three things: (1) now any change needed in the primer generation only requires the code to change in one place – greatly reducing the amount of work, and more importantly, the chance for error; (2) notice how ‘bases’ is defined in the function with a default value. You can probably imagine how many functions benefit from default parameter values. For the <code>genPrimer</code> function above you will most often only generate sequences with nucelotides found in DNA, so it makes sense to provide a default value for the bases. Almost all of the functions you will use in R run with default values that you may or may not be aware of; (3) notice an R function can only return one object. Here, we want to return both the primers and their lenghts. We can return multiple objects by storing them all in one list.</p>
<p>Similarly, you can functionalize the molecular weight and Tm calculators:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">primer_analysis</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">primers</span>) {

  <span class="no">nprimer</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">primers</span>$<span class="no">primer</span>)
  <span class="co"># Create results list</span>
  <span class="no">res</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span> (<span class="kw">primer</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span>(<span class="kw">length</span> <span class="kw">=</span> <span class="no">nprimer</span>),
               <span class="kw">mw</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span>(<span class="kw">length</span> <span class="kw">=</span> <span class="no">nprimer</span>),
               <span class="kw">Tm</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span>(<span class="kw">length</span> <span class="kw">=</span> <span class="no">nprimer</span>),
               <span class="kw">length</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span>(<span class="kw">length</span> <span class="kw">=</span> <span class="no">nprimer</span>))

  <span class="co"># For-loop iterating through the 1:(number of primers)</span>
  <span class="kw">for</span> (<span class="no">p</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="no">nprimer</span>) {

    <span class="no">sequence</span> <span class="kw">&lt;-</span> <span class="no">primers</span>$<span class="no">primer</span>[<span class="no">p</span>]
    <span class="no">len</span> <span class="kw">&lt;-</span> <span class="no">primers</span>$<span class="no">length</span>[<span class="no">p</span>]

    <span class="co"># Count bases</span>
    <span class="no">nA</span> <span class="kw">&lt;-</span> <span class="fl">0</span> <span class="co"># number of A's</span>
    <span class="no">nC</span> <span class="kw">&lt;-</span> <span class="fl">0</span> <span class="co"># number of C's</span>
    <span class="no">nG</span> <span class="kw">&lt;-</span> <span class="fl">0</span> <span class="co"># number of G's</span>
    <span class="no">nT</span> <span class="kw">&lt;-</span> <span class="fl">0</span> <span class="co"># number of T's</span>

    <span class="kw">for</span> (<span class="no">j</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="no">len</span>) {
      <span class="no">l</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">sequence</span>, <span class="no">j</span>, <span class="no">j</span>) <span class="co"># Get jth nucleic acid of pth primer</span>
      <span class="kw">if</span> (<span class="no">l</span> <span class="kw">==</span> <span class="st">"C"</span>) {
        <span class="no">nC</span> <span class="kw">&lt;-</span> <span class="no">nC</span> + <span class="fl">1</span>
        <span class="no">m</span> <span class="kw">&lt;-</span> <span class="fl">467.2</span>
      } <span class="kw">else</span> <span class="kw">if</span> (<span class="no">l</span> <span class="kw">==</span> <span class="st">"A"</span>) {
        <span class="no">nA</span> <span class="kw">&lt;-</span> <span class="no">nA</span> + <span class="fl">1</span>
        <span class="no">m</span> <span class="kw">&lt;-</span> <span class="fl">491.2</span>
      } <span class="kw">else</span> <span class="kw">if</span> (<span class="no">l</span> <span class="kw">==</span> <span class="st">"G"</span>) {
        <span class="no">nG</span> <span class="kw">&lt;-</span> <span class="no">nG</span> + <span class="fl">1</span>
        <span class="no">m</span> <span class="kw">&lt;-</span> <span class="fl">507.2</span>
      } <span class="kw">else</span> <span class="kw">if</span> (<span class="no">l</span> <span class="kw">==</span> <span class="st">"T"</span>) {
        <span class="no">nT</span> <span class="kw">&lt;-</span> <span class="no">nT</span> + <span class="fl">1</span>
        <span class="no">m</span> <span class="kw">&lt;-</span> <span class="fl">482.2</span>
      }
    }  <span class="co"># End of count base for-loop</span>

    <span class="co"># Calculate mass</span>
    <span class="no">pmass</span> <span class="kw">&lt;-</span> <span class="no">nC</span>*<span class="fl">467.2</span> + <span class="no">nA</span>*<span class="fl">491.2</span> + <span class="no">nG</span>*<span class="fl">507.2</span> + <span class="no">nT</span>*<span class="fl">482.2</span>

    <span class="co"># Calculate Tm</span>
    <span class="kw">if</span> (<span class="no">len</span> <span class="kw">&lt;=</span> <span class="fl">13</span>) {
      <span class="no">Tm</span> <span class="kw">&lt;-</span> (<span class="no">nA</span> + <span class="no">nT</span>)*<span class="fl">2</span> + (<span class="no">nG</span> + <span class="no">nC</span>)*<span class="fl">4</span>
    } <span class="kw">else</span> {
      <span class="no">Tm</span> <span class="kw">&lt;-</span> <span class="fl">64.9</span> +<span class="fl">41</span>*(<span class="no">nG</span>+<span class="no">nC</span>-<span class="fl">16.4</span>)/(<span class="no">nA</span>+<span class="no">nT</span>+<span class="no">nG</span>+<span class="no">nC</span>)
    }

    <span class="co"># Assign values to the results matrix</span>
    <span class="no">res</span>$<span class="no">primer</span>[<span class="no">p</span>] <span class="kw">&lt;-</span> <span class="no">sequence</span>
    <span class="no">res</span>$<span class="no">mw</span>[<span class="no">p</span>] <span class="kw">&lt;-</span> <span class="no">pmass</span>
    <span class="no">res</span>$<span class="no">Tm</span>[<span class="no">p</span>] <span class="kw">&lt;-</span> <span class="no">Tm</span>
    <span class="no">res</span>$<span class="no">length</span>[<span class="no">p</span>] <span class="kw">&lt;-</span> <span class="no">len</span>

  } <span class="co"># End of primer for-loop</span>

  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">res</span>)

}</pre></body></html></div>
<p>Now you can use the <code>primer_analysis</code> function to the <code>primers1</code> and <code>primers2</code> datasets you generated.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">results1</span> <span class="kw">&lt;-</span> <span class="fu">primer_analysis</span>(<span class="no">primers1</span>)
<span class="no">results2</span> <span class="kw">&lt;-</span> <span class="fu">primer_analysis</span>(<span class="no">primers2</span>)</pre></body></html></div>
</div>
<div id="function-control-statements" class="section level3">
<h3 class="hasAnchor">
<a href="#function-control-statements" class="anchor"></a>Function control statements</h3>
<p>So far we have only discussed one aspect of function control statments: the <code>return</code> function. The <code>return</code> function can actually go anywhere in the function, and a function can have multiple <code>return</code> functions. For example consider a function that returns “big number” for numbers greater than or equal to 100 and “small number” for numbers under less than 100:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">xmpl_func</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) {

  <span class="kw">if</span> (<span class="no">x</span> <span class="kw">&gt;=</span> <span class="fl">100</span>) {
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="st">"big number"</span>)
  }

  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="st">"small number"</span>)

}
<span class="fu">xmpl_func</span>(<span class="fl">1</span>)
<span class="co">## [1] "small number"</span>
<span class="fu">xmpl_func</span>(<span class="fl">1e10</span>)
<span class="co">## [1] "big number"</span>
<span class="fu">xmpl_func</span>(<span class="st">"see what happens"</span>)
<span class="co">## [1] "big number"</span></pre></body></html></div>
<p>When a function encounters the <code>return</code> function the returns the value and halts any execution. The other two functions worth knowing are: <code>stop</code> and <code>warning</code>. The <code>stop</code> and <code>warning</code> functions allow you to do tests within the function and exit the function (<code>stop</code>) if necessary, or issue a warning (<code>warning</code>).</p>
<p>In the <code>xmpl_func("see what happens")</code> example, the function returned <code>TRUE</code>. (Recall from class 1 that both would be converted to character in the if statement, which is why the code did not error.) However, you may wish to make sure the input to <code>xmpl_func</code> is numeric and has a length of 1. Modify <code>xmpl_func</code> to test the input.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">xmpl_func</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) {

  <span class="co"># Test the length of x</span>
  <span class="kw">if</span> (<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>) <span class="kw">&gt;</span> <span class="fl">1</span>) <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"'x' must be of length 1."</span>)

  <span class="co"># Test the class of x</span>
  <span class="kw">if</span> (!<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span>(<span class="no">x</span>)) <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"'x' must be numeric."</span>)

  <span class="kw">if</span> (<span class="no">x</span> <span class="kw">&gt;=</span> <span class="fl">100</span>) {
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="st">"big number"</span>)
  }

  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="st">"small number"</span>)

}
<span class="fu">xmpl_func</span>(<span class="st">"see what happens"</span>)
<span class="co">## Error in xmpl_func("see what happens"): 'x' must be numeric.</span>
<span class="fu">xmpl_func</span>(<span class="fl">1</span>:<span class="fl">10</span>)
<span class="co">## Error in xmpl_func(1:10): 'x' must be of length 1.</span></pre></body></html></div>
<p>Finally, you may wish to issue a warning if the input can be converted to numeric instead of an error:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">xmpl_func</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) {

  <span class="co"># Test the length of x</span>
  <span class="kw">if</span> (<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">x</span>) <span class="kw">&gt;</span> <span class="fl">1</span>) <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"'x' must be of length 1."</span>)

  <span class="kw">if</span> (<span class="fu"><a href="https://rdrr.io/r/base/logical.html">is.logical</a></span>(<span class="no">x</span>)) {
    <span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">x</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/warning.html">warning</a></span>(<span class="st">"'x' was converted from logical to numeric."</span>)
  }

  <span class="kw">if</span> (!<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span>(<span class="no">x</span>)) <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"'x' could not be converted to numeric."</span>)

  <span class="kw">if</span> (<span class="no">x</span> <span class="kw">&gt;=</span> <span class="fl">100</span>) {
    <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="st">"big number"</span>)
  }

  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="st">"small number"</span>)

}
<span class="fu">xmpl_func</span>(<span class="st">"see what happens"</span>)
<span class="co">## Error in xmpl_func("see what happens"): 'x' could not be converted to numeric.</span>
<span class="fu">xmpl_func</span>(<span class="fl">TRUE</span>)
<span class="co">## Warning in xmpl_func(TRUE): 'x' was converted from logical to numeric.</span>
<span class="co">## [1] "small number"</span></pre></body></html></div>
<p>Notice the function completed when the input was logical. The <code>warning</code> function does not halt execution, but does print a warning message for the user.</p>
</div>
<div id="exercises" class="section level3">
<h3 class="hasAnchor">
<a href="#exercises" class="anchor"></a>Exercises</h3>
<p>These exercises are to help you solidify and expand on the information given above. We intentionally added some concepts that were not covered above, and hope that you will take a few minutes to think through what is happening and how R is interpreting the code.</p>
<ol style="list-style-type: decimal">
<li><p>Write a function that solves the quadratic formula. Recall, given: <span class="math display">\[ax^2 + bx + c = 0\]</span> The quadratic equation is: <span class="math display">\[x = \frac{-b\pm\sqrt{b^2-4ac}}{2a}\]</span> Use it to solve the following equations. <span class="math display">\[x^2+x-4=0\]</span> <span class="math display">\[x^2-3x-4=0\]</span> <span class="math display">\[6x^2+11x-35=0\]</span></p></li>
<li><p>Add the necessary checks for input length and class to the quadratic formula function from question 1.</p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Dayne L Filer, Amy Pomeroy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
