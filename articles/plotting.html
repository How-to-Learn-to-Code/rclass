<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HTLTC-R: Plotting • htltcR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="HTLTC-R: Plotting">
<meta property="og:description" content="htltcR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">htltcR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/control.html">HTLTC-R: Control statements</a>
    </li>
    <li>
      <a href="../articles/functions.html">HTLTC-R: Functions</a>
    </li>
    <li>
      <a href="../articles/graphics.html">HTLTC-R: Graphics</a>
    </li>
    <li>
      <a href="../articles/io.html">HTLTC-R: Reading, writing, and regular expressions</a>
    </li>
    <li>
      <a href="../articles/operators.html">HTLTC-R: Operators</a>
    </li>
    <li>
      <a href="../articles/package.html">HTLTC-R: Reproducible research &amp; packages</a>
    </li>
    <li>
      <a href="../articles/palettes.html">HTLTC-R: Color packages</a>
    </li>
    <li>
      <a href="../articles/plotting-ggplot.html">HTLTC-R: Plotting with ggplot2</a>
    </li>
    <li>
      <a href="../articles/plotting.html">HTLTC-R: Plotting</a>
    </li>
    <li>
      <a href="../articles/structures.html">HTLTC-R: Data structures &amp; subsetting</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>HTLTC-R: Plotting</h1>
            
      
      
      <div class="hidden name"><code>plotting.Rmd</code></div>

    </div>

    
    
<div id="using-this-document" class="section level3">
<h3 class="hasAnchor">
<a href="#using-this-document" class="anchor"></a>Using this document</h3>
<ul>
<li>Code blocks and R code have a grey background (note, code nested in the text is not highlighted in the pdf version of this document but is a different font).</li>
<li># indicates a comment, and anything after a comment will not be evaluated in R</li>
<li>The comments beginning with ## under the code in the grey code boxes are the output from the code directly above; any comments added by us will start with a single #</li>
<li>While you can copy and paste code into R, you will learn faster if you type out the commands yourself.</li>
<li>Read through the document after class. This is meant to be a reference, and ideally, you should be able to understand every line of code. If there is something you do not understand please email us with questions or ask in the following class (you’re probably not the only one with the same question!).</li>
</ul>
</div>
<div id="goals" class="section level3">
<h3 class="hasAnchor">
<a href="#goals" class="anchor"></a>Goals</h3>
<ol style="list-style-type: decimal">
<li>Make basic plots</li>
</ol>
</div>
<div id="importing-data-from-a-csv-file" class="section level3">
<h3 class="hasAnchor">
<a href="#importing-data-from-a-csv-file" class="anchor"></a>Importing data from a csv file</h3>
<p>You have been provided with the data set “yeastmutants.csv”. This data set includes data on the response of budding yeast to mating pheromone over time for following three cell types: wildtype (wt), an sst2 mutant (sst2), and a gpa1 mutant (gpa1). For each mutant there is data on the mean response of a population (avg) as well as the standard deviation of the response (stdev). The data set also includes the time for each data point. Let’s import it into R and store it as <code>dat</code> using the <code>read.csv</code> function. Here the argument <code>header</code> is set to <code>TRUE</code> because the data set has a header labeling each column.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">dat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="st">"yeastmutants.csv"</span>, <span class="kw">header</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>Now we can take a look at our data.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="no">dat</span>)
<span class="co">## [1] "data.frame"</span>
<span class="no">dat</span>
<span class="co">##    Time sst2.avg sst2.stdev   wt.avg   wt.stdev gpa1.avg gpa1.stdev</span>
<span class="co">## 1     0 1.000000 0.00000000 1.000000 0.00000000 1.000000 0.00000000</span>
<span class="co">## 2     5 1.136837 0.09389147 1.072776 0.09115671 1.057325 0.08164994</span>
<span class="co">## 3    10 1.287260 0.17363721 1.203336 0.14969849 1.168357 0.14578347</span>
<span class="co">## 4    15 1.468307 0.28511297 1.355571 0.23767208 1.295126 0.23039342</span>
<span class="co">## 5    20 1.743784 0.37276442 1.502573 0.32856109 1.431064 0.32072659</span>
<span class="co">## 6    25 1.969451 0.48747293 1.681677 0.42366003 1.614628 0.40513027</span>
<span class="co">## 7    30 2.238040 0.61199152 1.891336 0.51515710 1.759505 0.49942606</span>
<span class="co">## 8    35 2.562568 0.72005169 2.093010 0.60034859 1.891254 0.56851048</span>
<span class="co">## 9    40 2.882724 0.84589976 2.259807 0.68484877 2.105130 0.68865793</span>
<span class="co">## 10   45 3.173244 0.92524386 2.475061 0.76737933 2.268349 0.79249475</span>
<span class="co">## 11   50 3.492047 1.03084217 2.662022 0.83065122 2.468349 0.89058264</span>
<span class="co">## 12   55 3.777006 1.11674734 2.895606 0.90892127 2.635299 0.98186805</span>
<span class="co">## 13   60 4.085648 1.20400677 3.101005 0.98064725 2.784591 1.03479761</span>
<span class="co">## 14   65 4.371034 1.28763041 3.285258 1.02267586 2.946033 1.09631276</span>
<span class="co">## 15   70 4.665376 1.37728041 3.455390 1.05638858 3.113485 1.17051632</span>
<span class="co">## 16   75 4.850383 1.46856287 3.652236 1.10244107 3.314269 1.25634935</span>
<span class="co">## 17   80 5.073138 1.51458449 3.839015 1.13939773 3.466327 1.31108736</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">dat</span>)
<span class="co">## 'data.frame':    17 obs. of  7 variables:</span>
<span class="co">##  $ Time      : int  0 5 10 15 20 25 30 35 40 45 ...</span>
<span class="co">##  $ sst2.avg  : num  1 1.14 1.29 1.47 1.74 ...</span>
<span class="co">##  $ sst2.stdev: num  0 0.0939 0.1736 0.2851 0.3728 ...</span>
<span class="co">##  $ wt.avg    : num  1 1.07 1.2 1.36 1.5 ...</span>
<span class="co">##  $ wt.stdev  : num  0 0.0912 0.1497 0.2377 0.3286 ...</span>
<span class="co">##  $ gpa1.avg  : num  1 1.06 1.17 1.3 1.43 ...</span>
<span class="co">##  $ gpa1.stdev: num  0 0.0816 0.1458 0.2304 0.3207 ...</span></pre></body></html></div>
<p>Using the <code><a href="https://rdrr.io/r/base/class.html">class()</a></code> function we can tell that <code>dat</code> is a data.frame. This means it is a list of vectors each with the same length. Now, let’s look closer at the data itself; we see it looks like a table with 7 columns (each with a header) and 17 rows. We can also look at the structure of this data frame using the <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> function. It tells us that we have 17 observations of 7 variables and liststhe variables and their classes. <code>Time</code> is an integer and the rest of the variables are numeric.</p>
</div>
<div id="basic-plotting" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-plotting" class="anchor"></a>Basic plotting</h3>
<p>Now we have imported some data, so how can we visualize it? One of the most basic ways to visualize data is the the <code><a href="https://rdrr.io/r/base/plot.html">plot()</a></code> function. We can learn more about this function using <code><a href="https://rdrr.io/r/base/plot.html">?plot</a></code>. The <code>plot</code> function is used for generic X-Y plotting. It requires two arguments <code>x</code> and <code>y</code>, which represent the x and y coordinates for the plot respectively. Then the function also has lots of optional arguments. <code>type</code> is used indicate what type of plot should be drawn; all of the options for this are listed in the help menu. <code>main</code> and <code>sub</code> are used to give the plot an overall and a subtitle, respectively. <code>xlab</code> and <code>ylab</code> are used to label the x and y axes. Finally, <code>asp</code> is used to assign the y/x aspect ratio. There are other arguments that can be passed to <code><a href="https://rdrr.io/r/base/plot.html">plot()</a></code>. You can google these if you’re interested or use <code><a href="https://rdrr.io/r/graphics/par.html">?par</a></code>; one we will be particuarly interested in is <code>col</code> which assigns a color.</p>
<p>Now let’s do a basic plotting example. We want to plot the average response of wildtype cells versus time. We will need to subset the average response of wt and time from the data.frame and plot them. We can do this using the <code><a href="https://rdrr.io/r/base/Extract.html">$</a></code> operator.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">dat</span>$<span class="no">Time</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">dat</span>$<span class="no">wt.avg</span>)</pre></body></html></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>We also want to give the plot an appropriate title and axis labels.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">dat</span>$<span class="no">Time</span>,
     <span class="kw">y</span> <span class="kw">=</span> <span class="no">dat</span>$<span class="no">wt.avg</span>,
     <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Yeast Response to Pheromone"</span>,
     <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Time (minutes)"</span>,
     <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Mean pheromone response"</span>)</pre></body></html></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>In order to add more data sets to the existing plot we need to use the <code>lines</code> or the <code>points</code> functions. The use of the <code>points</code> function to compare the response of wildtype to the gpa1 mutant is shown below.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">dat</span>$<span class="no">Time</span>,
     <span class="kw">y</span> <span class="kw">=</span> <span class="no">dat</span>$<span class="no">wt.avg</span>,
     <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Yeast Response to Pheromone"</span>,
     <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Time (minutes)"</span>,
     <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Mean pheromone response"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">dat</span>$<span class="no">Time</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">dat</span>$<span class="no">gpa1.avg</span>)</pre></body></html></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>We can also change the color of the points and add a legend to be able to tell which is which. The legend is a little more complicated. We first specify the location <code>"bottomright"</code>, then we include a vector with the label for each legend entry <code><a href="https://rdrr.io/r/base/c.html">c("wildtype","gpa1 mutant")</a></code>. <code>lty = 0</code> indicates that the line type is zero, or there is not line. <code>pch = 1</code> indicates the point character is 1 - the open circle. Finally, we say that the colors should be black and red respectively with <code>col = c("black","red")</code>.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">dat</span>$<span class="no">Time</span>,
     <span class="kw">y</span> <span class="kw">=</span> <span class="no">dat</span>$<span class="no">wt.avg</span>,
     <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Yeast Response to Pheromone"</span>,
     <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Time (minutes)"</span>,
     <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Mean pheromone response"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">dat</span>$<span class="no">Time</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">dat</span>$<span class="no">gpa1.avg</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"red"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"bottomright"</span>,
       <span class="kw">legend</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"wildtype"</span>,<span class="st">"gpa1 mutant"</span>),
       <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">0</span>,
       <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">1</span>,
       <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"black"</span>,<span class="st">"red"</span>))</pre></body></html></div>
<p><img src="plotting_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<hr>
<div id="in-class-activities" class="section level4">
<h4 class="hasAnchor">
<a href="#in-class-activities" class="anchor"></a>In class activities</h4>
<p>The following questions are to be worked on in a small group. Always make sure that your plots have proper titles and axis labels.</p>
<ol style="list-style-type: decimal">
<li><p>Plot the average pheromone response for all three cell types. Plot them as lines, not points (remember: the argument <code>type</code> for <code>plot</code> and the function <code>lines</code> which is similar to <code>points</code>). Make each cell type a different color and create a legend to match.</p></li>
<li><p>Noise in cellular response is often quantified by the coefficient of variation (CV) because it normalizes the standard deviation for differences in the mean. CV is defined as <span class="math inline">\(CV=\sigma/\mu\)</span> where <span class="math inline">\(\sigma\)</span> is the standard deviation and <span class="math inline">\(\mu\)</span> is mean. Create new variables in the data frame for the CV for each cell type. (Rememeber: you can use subsetting to assign new variables). Then create a plot of the CV for all cell types following the same guidelines as in question 1.</p></li>
</ol>
<hr>
<p>There are many things you can do with plotting in R. The following problems will give you a chance to explore some of the many plotting functions available including <code><a href="https://rdrr.io/r/graphics/hist.html">hist()</a></code>, <code><a href="https://rdrr.io/r/graphics/barplot.html">barplot()</a></code>, and <code><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot()</a></code></p>
</div>
</div>
<div id="exercises" class="section level3">
<h3 class="hasAnchor">
<a href="#exercises" class="anchor"></a>Exercises</h3>
<p>The following questions are to be done for homework. They require the data in the file “heights.csv” which includes the gender, height, handedness, and eye color. To answer these questions you will use different types of plots including histograms, bar plots, and box plots. You can learn about all the required arguments by using the help section.</p>
<ol style="list-style-type: decimal">
<li><p>Make a histogram of height using the <code><a href="https://rdrr.io/r/graphics/hist.html">hist()</a></code> function. Include an appropriate title and axis labels.</p></li>
<li><p>Now make the same histogram but include 20 bins and make it your favorite color.</p></li>
<li><p>Make a bar chart of how many people are left or right handed using the <code><a href="https://rdrr.io/r/graphics/barplot.html">barplot()</a></code> function. Hint: <code>dat$Handedness[dat$Handedness=="Left"]</code> will return a vector including on those entries where <code>dat$Handedness</code> is <code>"Left"</code> and <code><a href="https://rdrr.io/r/base/length.html">length()</a></code> will return the length of a vector.</p></li>
<li><p>Make a bar chart of how many people have the following eye colors: blue, brown, other. Make the color of each bar correspond to the eye color (you can choose any color for other).</p></li>
<li><p>Make a box plot of the height using the <code><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot()</a></code> function.</p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Dayne L Filer, Amy Pomperoy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
